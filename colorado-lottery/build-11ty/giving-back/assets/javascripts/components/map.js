"use strict";function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(i,e,n){return e&&t(i.prototype,e),n&&t(i,n),i}}(),Map=function(){function t(){var i=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];_classCallCheck(this,t),this.$el=$(i.el),this.animations={},this.isIE11()?this.initStaticMap():(this.initializeMap(),$("body").on("click","path[data-href]",function(t){window.location.href=$(t.target).data("href")})),this.bindEvents(),this.introCookie="intro4",this.getCookie(this.introCookie)&&this.hideIntro()}return _createClass(t,[{key:"isIE11",value:function(){return-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0}},{key:"initStaticMap",value:function(){var t=this;document.body.classList.add("explore-static"),this.staticMapEl=document.querySelector("div.explore-static"),this.staticMapImg=this.staticMapEl.querySelector("img"),this.staticMapImg.setAttribute("src",this.staticMapImg.getAttribute("data-src")),this.staticMapSVG=this.staticMapEl.querySelector("svg"),this.$el.css("visibility","visible"),this.setSVGToIMGSize(),window.addEventListener("resize",function(){t.setSVGToIMGSize()}),window.addEventListener("load",function(){t.setSVGToIMGSize()})}},{key:"setSVGToIMGSize",value:function(){var t=this.staticMapImg.getBoundingClientRect();this.staticMapSVG.setAttribute("width",t.width),this.staticMapSVG.setAttribute("height",t.height),this.staticMapSVG.setAttribute("style","width:"+t.width+"px; height:"+t.height+"px;")}},{key:"bindEvents",value:function(){this.$el.on("click","div.intro a.close-intro",this.hideIntro.bind(this))}},{key:"initializeMap",value:function(){this.$svg=this.$el.find("#svg"),this.$svg.find(".primary").hide();var t=this.$svg.parent(),i=(this.$svg.height()-t.height())/2,e=(this.$svg.width()-t.width())/2;t.scrollTop(i),t.scrollLeft(e),window.mobilecheck()||(this.$svg.find("g.hover-layer path").hover(this.onMouseIn.bind(this),this.onMouseOut.bind(this)),this.createAnimation("western-slope","#skull","dinosaur-ridge-skull.json"),this.createAnimation("western-slope","#glenwood-springs","glenwood-springs.json"),this.createAnimation("northern-front-range","#rodeo","rodeo.json"),this.createAnimation("southern","#pond","pond.json"),this.createAnimation("eastern","#sign","welcome-sign.json"),this.createAnimation("southwest","#falls-mist","falls-mist.json"),this.createAnimation("southwest","#train-smoke","train-smoke.json"),this.createAnimation("southern","#ufo-flames","ufo-flames.json"),this.createAnimation("northern-front-range","#snow","snow.json"),this.createAnimation("front-range","#denver-windows","denver-windows.json"),this.createAnimation("mountain","#hanging-lake-glimmer","hanging-lake-glimmer.json"),this.createAnimation("front-range","#music","music.json"),this.createAnimation("eastern","#cow","cow.json"),this.createAnimation("mountain","#raft","raft.json"),this.createAnimation("front-range","#garden","garden-of-the-gods.json"),this.createAnimation("eastern","#windmill","windmill.json")),this.$el.css("visibility","visible")}},{key:"createAnimation",value:function(t,i,e){var n=this.$svg.find(i),a=bodymovin.loadAnimation({container:n.get(0),renderer:"svg",loop:!0,autoplay:!1,path:"assets/javascripts/map/"+e});a.addEventListener("data_ready",function(){n.find("g.original").hide()}),this.animations[t]=this.animations[t]||[],this.animations[t].push(a)}},{key:"onMouseIn",value:function(t){var i=$(t.target).data("region");this.$svg.addClass(i);var e=!0,n=!1,a=undefined;try{for(var s,o=(this.animations[i]||[])[Symbol.iterator]();!(e=(s=o.next()).done);e=!0){s.value.play()}}catch(t){n=!0,a=t}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw a}}}},{key:"onMouseOut",value:function(t){var i=$(t.target).data("region");this.$svg.removeClass(i);var e=!0,n=!1,a=undefined;try{for(var s,o=(this.animations[i]||[])[Symbol.iterator]();!(e=(s=o.next()).done);e=!0){s.value.pause()}}catch(t){n=!0,a=t}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw a}}}},{key:"hideIntro",value:function(t){$("body").find("nav a.logo").show(),t&&t.preventDefault(),document.cookie=this.introCookie+"=true",this.$el.find("div.intro").hide(),this.$svg&&this.$svg.find(".primary").show()}},{key:"getCookie",value:function(t){var i=t+"=",e=!0,n=!1,a=undefined;try{for(var s,o=document.cookie.split(";")[Symbol.iterator]();!(e=(s=o.next()).done);e=!0){for(var r=s.value;" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(i))return r.substring(i.length,r.length)}}catch(t){n=!0,a=t}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw a}}return""}}]),t}();Bindable.register("map",Map);