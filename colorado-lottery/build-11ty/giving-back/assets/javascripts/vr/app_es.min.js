/*! cactus-lottery-proceeds-vr 2018-06-06 */


if(!("forEach"in Array.prototype)){Array.prototype.forEach=function(action,that){for(var i=0,n=this.length;i<n;i++)if(i in this)action.call(that,this[i],i,this)}}if(!("map"in Array.prototype)){Array.prototype.map=function(mapper,that){var other=new Array(this.length);for(var i=0,n=this.length;i<n;i++)if(i in this)other[i]=mapper.call(that,this[i],i,this);return other}}if(!("filter"in Array.prototype)){Array.prototype.filter=function(filter,that){var other=[],v;for(var i=0,n=this.length;i<n;i++)if(i in this&&filter.call(that,v=this[i],i,this))other.push(v);return other}}NodeList.prototype.forEach=Array.prototype.forEach;(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?module.exports=factory():typeof define==="function"&&define.amd?define(factory):global.page=factory()})(this,function(){"use strict";var isarray=Array.isArray||function(arr){return Object.prototype.toString.call(arr)=="[object Array]"};var pathToRegexp_1=pathToRegexp;var parse_1=parse;var compile_1=compile;var tokensToFunction_1=tokensToFunction;var tokensToRegExp_1=tokensToRegExp;var PATH_REGEXP=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function parse(str){var tokens=[];var key=0;var index=0;var path="";var res;while((res=PATH_REGEXP.exec(str))!=null){var m=res[0];var escaped=res[1];var offset=res.index;path+=str.slice(index,offset);index=offset+m.length;if(escaped){path+=escaped[1];continue}if(path){tokens.push(path);path=""}var prefix=res[2];var name=res[3];var capture=res[4];var group=res[5];var suffix=res[6];var asterisk=res[7];var repeat=suffix==="+"||suffix==="*";var optional=suffix==="?"||suffix==="*";var delimiter=prefix||"/";var pattern=capture||group||(asterisk?".*":"[^"+delimiter+"]+?");tokens.push({name:name||key++,prefix:prefix||"",delimiter:delimiter,optional:optional,repeat:repeat,pattern:escapeGroup(pattern)})}if(index<str.length){path+=str.substr(index)}if(path){tokens.push(path)}return tokens}function compile(str){return tokensToFunction(parse(str))}function tokensToFunction(tokens){var matches=new Array(tokens.length);for(var i=0;i<tokens.length;i++){if(typeof tokens[i]==="object"){matches[i]=new RegExp("^"+tokens[i].pattern+"$")}}return function(obj){var path="";var data=obj||{};for(var i=0;i<tokens.length;i++){var token=tokens[i];if(typeof token==="string"){path+=token;continue}var value=data[token.name];var segment;if(value==null){if(token.optional){continue}else{throw new TypeError('Expected "'+token.name+'" to be defined')}}if(isarray(value)){if(!token.repeat){throw new TypeError('Expected "'+token.name+'" to not repeat, but received "'+value+'"')}if(value.length===0){if(token.optional){continue}else{throw new TypeError('Expected "'+token.name+'" to not be empty')}}for(var j=0;j<value.length;j++){segment=encodeURIComponent(value[j]);if(!matches[i].test(segment)){throw new TypeError('Expected all "'+token.name+'" to match "'+token.pattern+'", but received "'+segment+'"')}path+=(j===0?token.prefix:token.delimiter)+segment}continue}segment=encodeURIComponent(value);if(!matches[i].test(segment)){throw new TypeError('Expected "'+token.name+'" to match "'+token.pattern+'", but received "'+segment+'"')}path+=token.prefix+segment}return path}}function escapeString(str){return str.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")}function escapeGroup(group){return group.replace(/([=!:$\/()])/g,"\\$1")}function attachKeys(re,keys){re.keys=keys;return re}function flags(options){return options.sensitive?"":"i"}function regexpToRegexp(path,keys){var groups=path.source.match(/\((?!\?)/g);if(groups){for(var i=0;i<groups.length;i++){keys.push({name:i,prefix:null,delimiter:null,optional:false,repeat:false,pattern:null})}}return attachKeys(path,keys)}function arrayToRegexp(path,keys,options){var parts=[];for(var i=0;i<path.length;i++){parts.push(pathToRegexp(path[i],keys,options).source)}var regexp=new RegExp("(?:"+parts.join("|")+")",flags(options));return attachKeys(regexp,keys)}function stringToRegexp(path,keys,options){var tokens=parse(path);var re=tokensToRegExp(tokens,options);for(var i=0;i<tokens.length;i++){if(typeof tokens[i]!=="string"){keys.push(tokens[i])}}return attachKeys(re,keys)}function tokensToRegExp(tokens,options){options=options||{};var strict=options.strict;var end=options.end!==false;var route="";var lastToken=tokens[tokens.length-1];var endsWithSlash=typeof lastToken==="string"&&/\/$/.test(lastToken);for(var i=0;i<tokens.length;i++){var token=tokens[i];if(typeof token==="string"){route+=escapeString(token)}else{var prefix=escapeString(token.prefix);var capture=token.pattern;if(token.repeat){capture+="(?:"+prefix+capture+")*"}if(token.optional){if(prefix){capture="(?:"+prefix+"("+capture+"))?"}else{capture="("+capture+")?"}}else{capture=prefix+"("+capture+")"}route+=capture}}if(!strict){route=(endsWithSlash?route.slice(0,-2):route)+"(?:\\/(?=$))?"}if(end){route+="$"}else{route+=strict&&endsWithSlash?"":"(?=\\/|$)"}return new RegExp("^"+route,flags(options))}function pathToRegexp(path,keys,options){keys=keys||[];if(!isarray(keys)){options=keys;keys=[]}else if(!options){options={}}if(path instanceof RegExp){return regexpToRegexp(path,keys,options)}if(isarray(path)){return arrayToRegexp(path,keys,options)}return stringToRegexp(path,keys,options)}pathToRegexp_1.parse=parse_1;pathToRegexp_1.compile=compile_1;pathToRegexp_1.tokensToFunction=tokensToFunction_1;pathToRegexp_1.tokensToRegExp=tokensToRegExp_1;var page_js=page;page.default=page;page.Context=Context;page.Route=Route;page.sameOrigin=sameOrigin;var hasDocument="undefined"!==typeof document;var hasWindow="undefined"!==typeof window;var hasHistory="undefined"!==typeof history;var hasProcess=typeof process!=="undefined";var clickEvent=hasDocument&&document.ontouchstart?"touchstart":"click";var isLocation=hasWindow&&!!(window.history.location||window.location);var dispatch=true;var decodeURLComponents=true;var base="";var strict=false;var running;var hashbang=false;var prevContext;var pageWindow;function page(path,fn){if("function"===typeof path){return page("*",path)}if("function"===typeof fn){var route=new Route(path);for(var i=1;i<arguments.length;++i){page.callbacks.push(route.middleware(arguments[i]))}}else if("string"===typeof path){page["string"===typeof fn?"redirect":"show"](path,fn)}else{page.start(path)}}page.callbacks=[];page.exits=[];page.current="";page.len=0;page.base=function(path){if(0===arguments.length)return base;base=path};page.strict=function(enable){if(0===arguments.length)return strict;strict=enable};page.start=function(options){options=options||{};if(running)return;running=true;pageWindow=options.window||hasWindow&&window;if(false===options.dispatch)dispatch=false;if(false===options.decodeURLComponents)decodeURLComponents=false;if(false!==options.popstate&&hasWindow)pageWindow.addEventListener("popstate",onpopstate,false);if(false!==options.click&&hasDocument){pageWindow.document.addEventListener(clickEvent,onclick,false)}hashbang=!!options.hashbang;if(hashbang&&hasWindow&&!hasHistory){pageWindow.addEventListener("hashchange",onpopstate,false)}if(!dispatch)return;var url;if(isLocation){var loc=pageWindow.location;if(hashbang&&~loc.hash.indexOf("#!")){url=loc.hash.substr(2)+loc.search}else if(hashbang){url=loc.search+loc.hash}else{url=loc.pathname+loc.search+loc.hash}}page.replace(url,null,true,dispatch)};page.stop=function(){if(!running)return;page.current="";page.len=0;running=false;hasDocument&&pageWindow.document.removeEventListener(clickEvent,onclick,false);hasWindow&&pageWindow.removeEventListener("popstate",onpopstate,false);hasWindow&&pageWindow.removeEventListener("hashchange",onpopstate,false)};page.show=function(path,state,dispatch,push){var ctx=new Context(path,state),prev=prevContext;prevContext=ctx;page.current=ctx.path;if(false!==dispatch)page.dispatch(ctx,prev);if(false!==ctx.handled&&false!==push)ctx.pushState();return ctx};page.back=function(path,state){if(page.len>0){hasHistory&&pageWindow.history.back();page.len--}else if(path){setTimeout(function(){page.show(path,state)})}else{setTimeout(function(){page.show(getBase(),state)})}};page.redirect=function(from,to){if("string"===typeof from&&"string"===typeof to){page(from,function(e){setTimeout(function(){page.replace(to)},0)})}if("string"===typeof from&&"undefined"===typeof to){setTimeout(function(){page.replace(from)},0)}};page.replace=function(path,state,init,dispatch){var ctx=new Context(path,state),prev=prevContext;prevContext=ctx;page.current=ctx.path;ctx.init=init;ctx.save();if(false!==dispatch)page.dispatch(ctx,prev);return ctx};page.dispatch=function(ctx,prev){var i=0,j=0;function nextExit(){var fn=page.exits[j++];if(!fn)return nextEnter();fn(prev,nextExit)}function nextEnter(){var fn=page.callbacks[i++];if(ctx.path!==page.current){ctx.handled=false;return}if(!fn)return unhandled(ctx);fn(ctx,nextEnter)}if(prev){nextExit()}else{nextEnter()}};function unhandled(ctx){if(ctx.handled)return;var current;if(hashbang){current=isLocation&&getBase()+pageWindow.location.hash.replace("#!","")}else{current=isLocation&&pageWindow.location.pathname+pageWindow.location.search}if(current===ctx.canonicalPath)return;page.stop();ctx.handled=false;isLocation&&(pageWindow.location.href=ctx.canonicalPath)}page.exit=function(path,fn){if(typeof path==="function"){return page.exit("*",path)}var route=new Route(path);for(var i=1;i<arguments.length;++i){page.exits.push(route.middleware(arguments[i]))}};function decodeURLEncodedURIComponent(val){if(typeof val!=="string"){return val}return decodeURLComponents?decodeURIComponent(val.replace(/\+/g," ")):val}function Context(path,state){var pageBase=getBase();if("/"===path[0]&&0!==path.indexOf(pageBase))path=pageBase+(hashbang?"#!":"")+path;var i=path.indexOf("?");this.canonicalPath=path;this.path=path.replace(pageBase,"")||"/";if(hashbang)this.path=this.path.replace("#!","")||"/";this.title=hasDocument&&pageWindow.document.title;this.state=state||{};this.state.path=path;this.querystring=~i?decodeURLEncodedURIComponent(path.slice(i+1)):"";this.pathname=decodeURLEncodedURIComponent(~i?path.slice(0,i):path);this.params={};this.hash="";if(!hashbang){if(!~this.path.indexOf("#"))return;var parts=this.path.split("#");this.path=this.pathname=parts[0];this.hash=decodeURLEncodedURIComponent(parts[1])||"";this.querystring=this.querystring.split("#")[0]}}page.Context=Context;Context.prototype.pushState=function(){page.len++;if(hasHistory){pageWindow.history.pushState(this.state,this.title,hashbang&&this.path!=="/"?"#!"+this.path:this.canonicalPath)}};Context.prototype.save=function(){if(hasHistory&&pageWindow.location.protocol!=="file:"){pageWindow.history.replaceState(this.state,this.title,hashbang&&this.path!=="/"?"#!"+this.path:this.canonicalPath)}};function Route(path,options){options=options||{};options.strict=options.strict||strict;this.path=path==="*"?"(.*)":path;this.method="GET";this.regexp=pathToRegexp_1(this.path,this.keys=[],options)}page.Route=Route;Route.prototype.middleware=function(fn){var self=this;return function(ctx,next){if(self.match(ctx.path,ctx.params))return fn(ctx,next);next()}};Route.prototype.match=function(path,params){var keys=this.keys,qsIndex=path.indexOf("?"),pathname=~qsIndex?path.slice(0,qsIndex):path,m=this.regexp.exec(decodeURIComponent(pathname));if(!m)return false;for(var i=1,len=m.length;i<len;++i){var key=keys[i-1];var val=decodeURLEncodedURIComponent(m[i]);if(val!==undefined||!hasOwnProperty.call(params,key.name)){params[key.name]=val}}return true};var onpopstate=function(){var loaded=false;if(!hasWindow){return}if(hasDocument&&document.readyState==="complete"){loaded=true}else{window.addEventListener("load",function(){setTimeout(function(){loaded=true},0)})}return function onpopstate(e){if(!loaded)return;if(e.state){var path=e.state.path;page.replace(path,e.state)}else if(isLocation){var loc=pageWindow.location;page.show(loc.pathname+loc.hash,undefined,undefined,false)}}}();function onclick(e){if(1!==which(e))return;if(e.metaKey||e.ctrlKey||e.shiftKey)return;if(e.defaultPrevented)return;var el=e.target;var eventPath=e.path||(e.composedPath?e.composedPath():null);if(eventPath){for(var i=0;i<eventPath.length;i++){if(!eventPath[i].nodeName)continue;if(eventPath[i].nodeName.toUpperCase()!=="A")continue;if(!eventPath[i].href)continue;el=eventPath[i];break}}while(el&&"A"!==el.nodeName.toUpperCase())el=el.parentNode;if(!el||"A"!==el.nodeName.toUpperCase())return;var svg=typeof el.href==="object"&&el.href.constructor.name==="SVGAnimatedString";if(el.hasAttribute("download")||el.getAttribute("rel")==="external")return;var link=el.getAttribute("href");if(!hashbang&&samePath(el)&&(el.hash||"#"===link))return;if(link&&link.indexOf("mailto:")>-1)return;if(svg?el.target.baseVal:el.target)return;if(!svg&&!sameOrigin(el.href))return;var path=svg?el.href.baseVal:el.pathname+el.search+(el.hash||"");path=path[0]!=="/"?"/"+path:path;if(hasProcess&&path.match(/^\/[a-zA-Z]:\//)){path=path.replace(/^\/[a-zA-Z]:\//,"/")}var orig=path;var pageBase=getBase();if(path.indexOf(pageBase)===0){path=path.substr(base.length)}if(hashbang)path=path.replace("#!","");if(pageBase&&orig===path)return;e.preventDefault();page.show(orig)}function which(e){e=e||hasWindow&&window.event;return null==e.which?e.button:e.which}function toURL(href){if(typeof URL==="function"&&isLocation){return new URL(href,location.toString())}else if(hasDocument){var anc=document.createElement("a");anc.href=href;return anc}}function sameOrigin(href){if(!href||!isLocation)return false;var url=toURL(href);var loc=pageWindow.location;return loc.protocol===url.protocol&&loc.hostname===url.hostname&&loc.port===url.port}function samePath(url){if(!isLocation)return false;var loc=pageWindow.location;return url.pathname===loc.pathname&&url.search===loc.search}function getBase(){if(!!base)return base;var loc=hasWindow&&pageWindow&&pageWindow.location;return hasWindow&&hashbang&&loc&&loc.protocol==="file:"?loc.pathname:base}page.sameOrigin=sameOrigin;return page_js});!function(){"use strict";var e=function(){this.init()};e.prototype={init:function(){var e=this||n;return e._counter=1e3,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.mobileAutoEnable=!0,e._setup(),e},volume:function(e){var t=this||n;if(e=parseFloat(e),t.ctx||_(),void 0!==e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,n.ctx.currentTime);for(var o=0;o<t._howls.length;o++)if(!t._howls[o]._webAudio)for(var r=t._howls[o]._getSoundIds(),a=0;a<r.length;a++){var u=t._howls[o]._soundById(r[a]);u&&u._node&&(u._node.volume=u._volume*e)}return t}return t._volume},mute:function(e){var t=this||n;t.ctx||_(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,n.ctx.currentTime);for(var o=0;o<t._howls.length;o++)if(!t._howls[o]._webAudio)for(var r=t._howls[o]._getSoundIds(),a=0;a<r.length;a++){var u=t._howls[o]._soundById(r[a]);u&&u._node&&(u._node.muted=!!e||u._muted)}return t},unload:function(){for(var e=this||n,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,_()),e},codecs:function(e){return(this||n)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||n;if(e.state=e.ctx?e.ctx.state||"running":"running",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{var t=new Audio;void 0===t.oncanplaythrough&&(e._canPlayEvent="canplay")}catch(n){e.noAudio=!0}else e.noAudio=!0;try{var t=new Audio;t.muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||n,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(n){return e}if(!t||"function"!=typeof t.canPlayType)return e;var o=t.canPlayType("audio/mpeg;").replace(/^no$/,""),r=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),a=r&&parseInt(r[0].split("/")[1],10)<33;return e._codecs={mp3:!(a||!o&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!o,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_enableMobileAudio:function(){var e=this||n,t=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(e._navigator&&e._navigator.userAgent),o=!!("ontouchend"in window||e._navigator&&e._navigator.maxTouchPoints>0||e._navigator&&e._navigator.msMaxTouchPoints>0);if(!e._mobileEnabled&&e.ctx&&(t||o)){e._mobileEnabled=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var r=function(){n._autoResume();var t=e.ctx.createBufferSource();t.buffer=e._scratchBuffer,t.connect(e.ctx.destination),void 0===t.start?t.noteOn(0):t.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),t.onended=function(){t.disconnect(0),e._mobileEnabled=!0,e.mobileAutoEnable=!1,document.removeEventListener("touchstart",r,!0),document.removeEventListener("touchend",r,!0)}};return document.addEventListener("touchstart",r,!0),document.addEventListener("touchend",r,!0),e}},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&n.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var o=0;o<e._howls[t]._sounds.length;o++)if(!e._howls[t]._sounds[o]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){e.autoSuspend&&(e._suspendTimer=null,e.state="suspending",e.ctx.suspend().then(function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())}))},3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&n.usingWebAudio)return"running"===e.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state?(e.ctx.resume().then(function(){e.state="running";for(var n=0;n<e._howls.length;n++)e._howls[n]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var n=new e,t=function(e){var n=this;if(!e.src||0===e.src.length)return void console.error("An array of source files must be passed with any new Howl.");n.init(e)};t.prototype={init:function(e){var t=this;return n.ctx||_(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhrWithCredentials=e.xhrWithCredentials||!1,t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onresume=[],t._webAudio=n.usingWebAudio&&!t._html5,void 0!==n.ctx&&n.ctx&&n.mobileAutoEnable&&n._enableMobileAudio(),n._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&t.load(),t},load:function(){var e=this,t=null;if(n.noAudio)return void e._emit("loaderror",null,"No audio support.");"string"==typeof e._src&&(e._src=[e._src]);for(var r=0;r<e._src.length;r++){var u,i;if(e._format&&e._format[r])u=e._format[r];else{if("string"!=typeof(i=e._src[r])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}u=/^data:audio\/([^;,]+);/i.exec(i),u||(u=/\.([^.]+)$/.exec(i.split("?",1)[0])),u&&(u=u[1].toLowerCase())}if(u||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),u&&n.codecs(u)){t=e._src[r];break}}return t?(e._src=t,e._state="loading","https:"===window.location.protocol&&"http:"===t.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new o(e),e._webAudio&&a(e),e):void e._emit("loaderror",null,"No codec support for selected audio sources.")},play:function(e,t){var o=this,r=null;if("number"==typeof e)r=e,e=null;else{if("string"==typeof e&&"loaded"===o._state&&!o._sprite[e])return null;if(void 0===e){e="__default";for(var a=0,u=0;u<o._sounds.length;u++)o._sounds[u]._paused&&!o._sounds[u]._ended&&(a++,r=o._sounds[u]._id);1===a?e=null:r=null}}var i=r?o._soundById(r):o._inactiveSound();if(!i)return null;if(r&&!e&&(e=i._sprite||"__default"),"loaded"!==o._state){i._sprite=e,i._ended=!1;var d=i._id;return o._queue.push({event:"play",action:function(){o.play(d)}}),d}if(r&&!i._paused)return t||setTimeout(function(){o._emit("play",i._id)},0),i._id;o._webAudio&&n._autoResume();var _=Math.max(0,i._seek>0?i._seek:o._sprite[e][0]/1e3),s=Math.max(0,(o._sprite[e][0]+o._sprite[e][1])/1e3-_),l=1e3*s/Math.abs(i._rate);i._paused=!1,i._ended=!1,i._sprite=e,i._seek=_,i._start=o._sprite[e][0]/1e3,i._stop=(o._sprite[e][0]+o._sprite[e][1])/1e3,i._loop=!(!i._loop&&!o._sprite[e][2]);var c=i._node;if(o._webAudio){var f=function(){o._refreshBuffer(i);var e=i._muted||o._muted?0:i._volume;c.gain.setValueAtTime(e,n.ctx.currentTime),i._playStart=n.ctx.currentTime,void 0===c.bufferSource.start?i._loop?c.bufferSource.noteGrainOn(0,_,86400):c.bufferSource.noteGrainOn(0,_,s):i._loop?c.bufferSource.start(0,_,86400):c.bufferSource.start(0,_,s),l!==1/0&&(o._endTimers[i._id]=setTimeout(o._ended.bind(o,i),l)),t||setTimeout(function(){o._emit("play",i._id)},0)};"running"===n.state?f():(o.once("resume",f),o._clearTimer(i._id))}else{var p=function(){c.currentTime=_,c.muted=i._muted||o._muted||n._muted||c.muted,c.volume=i._volume*n.volume(),c.playbackRate=i._rate;try{var e=c.play();if("undefined"!=typeof Promise&&e instanceof Promise&&(o._playLock=!0,e.then(function(){o._playLock=!1,o._loadQueue()})),c.paused)return void o._emit("playerror",i._id,"Playback was unable to start. This is most commonly an issue on mobile devices where playback was not within a user interaction.");l!==1/0&&(o._endTimers[i._id]=setTimeout(o._ended.bind(o,i),l)),t||o._emit("play",i._id)}catch(e){o._emit("playerror",i._id,e)}},m=window&&window.ejecta||!c.readyState&&n._navigator.isCocoonJS;if(4===c.readyState||m)p();else{var v=function(){p(),c.removeEventListener(n._canPlayEvent,v,!1)};c.addEventListener(n._canPlayEvent,v,!1),o._clearTimer(i._id)}}return i._id},pause:function(e){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"pause",action:function(){n.pause(e)}}),n;for(var t=n._getSoundIds(e),o=0;o<t.length;o++){n._clearTimer(t[o]);var r=n._soundById(t[o]);if(r&&!r._paused&&(r._seek=n.seek(t[o]),r._rateSeek=0,r._paused=!0,n._stopFade(t[o]),r._node))if(n._webAudio){if(!r._node.bufferSource)continue;void 0===r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),n._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||r._node.pause();arguments[1]||n._emit("pause",r?r._id:null)}return n},stop:function(e,n){var t=this;if("loaded"!==t._state)return t._queue.push({event:"stop",action:function(){t.stop(e)}}),t;for(var o=t._getSoundIds(e),r=0;r<o.length;r++){t._clearTimer(o[r]);var a=t._soundById(o[r]);a&&(a._seek=a._start||0,a._rateSeek=0,a._paused=!0,a._ended=!0,t._stopFade(o[r]),a._node&&(t._webAudio?a._node.bufferSource&&(void 0===a._node.bufferSource.stop?a._node.bufferSource.noteOff(0):a._node.bufferSource.stop(0),t._cleanBuffer(a._node)):isNaN(a._node.duration)&&a._node.duration!==1/0||(a._node.currentTime=a._start||0,a._node.pause())),n||t._emit("stop",a._id))}return t},mute:function(e,t){var o=this;if("loaded"!==o._state)return o._queue.push({event:"mute",action:function(){o.mute(e,t)}}),o;if(void 0===t){if("boolean"!=typeof e)return o._muted;o._muted=e}for(var r=o._getSoundIds(t),a=0;a<r.length;a++){var u=o._soundById(r[a]);u&&(u._muted=e,u._interval&&o._stopFade(u._id),o._webAudio&&u._node?u._node.gain.setValueAtTime(e?0:u._volume,n.ctx.currentTime):u._node&&(u._node.muted=!!n._muted||e),o._emit("mute",u._id))}return o},volume:function(){var e,t,o=this,r=arguments;if(0===r.length)return o._volume;if(1===r.length||2===r.length&&void 0===r[1]){o._getSoundIds().indexOf(r[0])>=0?t=parseInt(r[0],10):e=parseFloat(r[0])}else r.length>=2&&(e=parseFloat(r[0]),t=parseInt(r[1],10));var a;if(!(void 0!==e&&e>=0&&e<=1))return a=t?o._soundById(t):o._sounds[0],a?a._volume:0;if("loaded"!==o._state)return o._queue.push({event:"volume",action:function(){o.volume.apply(o,r)}}),o;void 0===t&&(o._volume=e),t=o._getSoundIds(t);for(var u=0;u<t.length;u++)(a=o._soundById(t[u]))&&(a._volume=e,r[2]||o._stopFade(t[u]),o._webAudio&&a._node&&!a._muted?a._node.gain.setValueAtTime(e,n.ctx.currentTime):a._node&&!a._muted&&(a._node.volume=e*n.volume()),o._emit("volume",a._id));return o},fade:function(e,t,o,r){var a=this;if("loaded"!==a._state)return a._queue.push({event:"fade",action:function(){a.fade(e,t,o,r)}}),a;a.volume(e,r);for(var u=a._getSoundIds(r),i=0;i<u.length;i++){var d=a._soundById(u[i]);if(d){if(r||a._stopFade(u[i]),a._webAudio&&!d._muted){var _=n.ctx.currentTime,s=_+o/1e3;d._volume=e,d._node.gain.setValueAtTime(e,_),d._node.gain.linearRampToValueAtTime(t,s)}a._startFadeInterval(d,e,t,o,u[i],void 0===r)}}return a},_startFadeInterval:function(e,n,t,o,r,a){var u=this,i=n,d=t-n,_=Math.abs(d/.01),s=Math.max(4,_>0?o/_:o),l=Date.now();e._fadeTo=t,e._interval=setInterval(function(){var r=(Date.now()-l)/o;l=Date.now(),i+=d*r,i=Math.max(0,i),i=Math.min(1,i),i=Math.round(100*i)/100,u._webAudio?e._volume=i:u.volume(i,e._id,!0),a&&(u._volume=i),(t<n&&i<=t||t>n&&i>=t)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,u.volume(t,e._id),u._emit("fade",e._id))},s)},_stopFade:function(e){var t=this,o=t._soundById(e);return o&&o._interval&&(t._webAudio&&o._node.gain.cancelScheduledValues(n.ctx.currentTime),clearInterval(o._interval),o._interval=null,t.volume(o._fadeTo,e),o._fadeTo=null,t._emit("fade",e)),t},loop:function(){var e,n,t,o=this,r=arguments;if(0===r.length)return o._loop;if(1===r.length){if("boolean"!=typeof r[0])return!!(t=o._soundById(parseInt(r[0],10)))&&t._loop;e=r[0],o._loop=e}else 2===r.length&&(e=r[0],n=parseInt(r[1],10));for(var a=o._getSoundIds(n),u=0;u<a.length;u++)(t=o._soundById(a[u]))&&(t._loop=e,o._webAudio&&t._node&&t._node.bufferSource&&(t._node.bufferSource.loop=e,e&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop)));return o},rate:function(){var e,t,o=this,r=arguments;if(0===r.length)t=o._sounds[0]._id;else if(1===r.length){var a=o._getSoundIds(),u=a.indexOf(r[0]);u>=0?t=parseInt(r[0],10):e=parseFloat(r[0])}else 2===r.length&&(e=parseFloat(r[0]),t=parseInt(r[1],10));var i;if("number"!=typeof e)return i=o._soundById(t),i?i._rate:o._rate;if("loaded"!==o._state)return o._queue.push({event:"rate",action:function(){o.rate.apply(o,r)}}),o;void 0===t&&(o._rate=e),t=o._getSoundIds(t);for(var d=0;d<t.length;d++)if(i=o._soundById(t[d])){i._rateSeek=o.seek(t[d]),i._playStart=o._webAudio?n.ctx.currentTime:i._playStart,i._rate=e,o._webAudio&&i._node&&i._node.bufferSource?i._node.bufferSource.playbackRate.setValueAtTime(e,n.ctx.currentTime):i._node&&(i._node.playbackRate=e);var _=o.seek(t[d]),s=(o._sprite[i._sprite][0]+o._sprite[i._sprite][1])/1e3-_,l=1e3*s/Math.abs(i._rate);!o._endTimers[t[d]]&&i._paused||(o._clearTimer(t[d]),o._endTimers[t[d]]=setTimeout(o._ended.bind(o,i),l)),o._emit("rate",i._id)}return o},seek:function(){var e,t,o=this,r=arguments;if(0===r.length)t=o._sounds[0]._id;else if(1===r.length){var a=o._getSoundIds(),u=a.indexOf(r[0]);u>=0?t=parseInt(r[0],10):o._sounds.length&&(t=o._sounds[0]._id,e=parseFloat(r[0]))}else 2===r.length&&(e=parseFloat(r[0]),t=parseInt(r[1],10));if(void 0===t)return o;if("loaded"!==o._state)return o._queue.push({event:"seek",action:function(){o.seek.apply(o,r)}}),o;var i=o._soundById(t);if(i){if(!("number"==typeof e&&e>=0)){if(o._webAudio){var d=o.playing(t)?n.ctx.currentTime-i._playStart:0,_=i._rateSeek?i._rateSeek-i._seek:0;return i._seek+(_+d*Math.abs(i._rate))}return i._node.currentTime}var s=o.playing(t);s&&o.pause(t,!0),i._seek=e,i._ended=!1,o._clearTimer(t),s&&o.play(t,!0),!o._webAudio&&i._node&&(i._node.currentTime=e),o._emit("seek",t)}return o},playing:function(e){var n=this;if("number"==typeof e){var t=n._soundById(e);return!!t&&!t._paused}for(var o=0;o<n._sounds.length;o++)if(!n._sounds[o]._paused)return!0;return!1},duration:function(e){var n=this,t=n._duration,o=n._soundById(e);return o&&(t=n._sprite[o._sprite][1]/1e3),t},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,o=0;o<t.length;o++){if(t[o]._paused||e.stop(t[o]._id),!e._webAudio){/MSIE |Trident\//.test(n._navigator&&n._navigator.userAgent)||(t[o]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),t[o]._node.removeEventListener("error",t[o]._errorFn,!1),t[o]._node.removeEventListener(n._canPlayEvent,t[o]._loadFn,!1)}delete t[o]._node,e._clearTimer(t[o]._id);var a=n._howls.indexOf(e);a>=0&&n._howls.splice(a,1)}var u=!0;for(o=0;o<n._howls.length;o++)if(n._howls[o]._src===e._src){u=!1;break}return r&&u&&delete r[e._src],n.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,n,t,o){var r=this,a=r["_on"+e];return"function"==typeof n&&a.push(o?{id:t,fn:n,once:o}:{id:t,fn:n}),r},off:function(e,n,t){var o=this,r=o["_on"+e],a=0;if("number"==typeof n&&(t=n,n=null),n||t)for(a=0;a<r.length;a++){var u=t===r[a].id;if(n===r[a].fn&&u||!n&&u){r.splice(a,1);break}}else if(e)o["_on"+e]=[];else{var i=Object.keys(o);for(a=0;a<i.length;a++)0===i[a].indexOf("_on")&&Array.isArray(o[i[a]])&&(o[i[a]]=[])}return o},once:function(e,n,t){var o=this;return o.on(e,n,t,1),o},_emit:function(e,n,t){for(var o=this,r=o["_on"+e],a=r.length-1;a>=0;a--)r[a].id&&r[a].id!==n&&"load"!==e||(setTimeout(function(e){e.call(this,n,t)}.bind(o,r[a].fn),0),r[a].once&&o.off(e,r[a].fn,r[a].id));return o},_loadQueue:function(){var e=this;if(e._queue.length>0){var n=e._queue[0];e.once(n.event,function(){e._queue.shift(),e._loadQueue()}),n.action()}return e},_ended:function(e){var t=this,o=e._sprite;if(!t._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(t._ended.bind(t,e),100),t;var r=!(!e._loop&&!t._sprite[o][2]);if(t._emit("end",e._id),!t._webAudio&&r&&t.stop(e._id,!0).play(e._id),t._webAudio&&r){t._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=n.ctx.currentTime;var a=1e3*(e._stop-e._start)/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),a)}return t._webAudio&&!r&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),n._autoSuspend()),t._webAudio||r||t.stop(e._id),t},_clearTimer:function(e){var n=this;return n._endTimers[e]&&(clearTimeout(n._endTimers[e]),delete n._endTimers[e]),n},_soundById:function(e){for(var n=this,t=0;t<n._sounds.length;t++)if(e===n._sounds[t]._id)return n._sounds[t];return null},_inactiveSound:function(){var e=this;e._drain();for(var n=0;n<e._sounds.length;n++)if(e._sounds[n]._ended)return e._sounds[n].reset();return new o(e)},_drain:function(){var e=this,n=e._pool,t=0,o=0;if(!(e._sounds.length<n)){for(o=0;o<e._sounds.length;o++)e._sounds[o]._ended&&t++;for(o=e._sounds.length-1;o>=0;o--){if(t<=n)return;e._sounds[o]._ended&&(e._webAudio&&e._sounds[o]._node&&e._sounds[o]._node.disconnect(0),e._sounds.splice(o,1),t--)}}},_getSoundIds:function(e){var n=this;if(void 0===e){for(var t=[],o=0;o<n._sounds.length;o++)t.push(n._sounds[o]._id);return t}return[e]},_refreshBuffer:function(e){var t=this;return e._node.bufferSource=n.ctx.createBufferSource(),e._node.bufferSource.buffer=r[t._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,n.ctx.currentTime),t},_cleanBuffer:function(e){var t=this;if(n._scratchBuffer){e.bufferSource.onended=null,e.bufferSource.disconnect(0);try{e.bufferSource.buffer=n._scratchBuffer}catch(e){}}return e.bufferSource=null,t}};var o=function(e){this._parent=e,this.init()};o.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++n._counter,t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,o=n._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node=void 0===n.ctx.createGain?n.ctx.createGainNode():n.ctx.createGain(),e._node.gain.setValueAtTime(o,n.ctx.currentTime),e._node.paused=!0,e._node.connect(n.masterGain)):(e._node=new Audio,e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(n._canPlayEvent,e._loadFn,!1),e._node.src=t._src,e._node.preload="auto",e._node.volume=o*n.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++n._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,t=e._parent;t._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),e._node.removeEventListener(n._canPlayEvent,e._loadFn,!1)}};var r={},a=function(e){var n=e._src;if(r[n])return e._duration=r[n].duration,void d(e);if(/^data:[^;]+;base64,/.test(n)){for(var t=atob(n.split(",")[1]),o=new Uint8Array(t.length),a=0;a<t.length;++a)o[a]=t.charCodeAt(a);i(o.buffer,e)}else{var _=new XMLHttpRequest;_.open("GET",n,!0),_.withCredentials=e._xhrWithCredentials,_.responseType="arraybuffer",_.onload=function(){var n=(_.status+"")[0];if("0"!==n&&"2"!==n&&"3"!==n)return void e._emit("loaderror",null,"Failed loading audio file with status: "+_.status+".");i(_.response,e)},_.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete r[n],e.load())},u(_)}},u=function(e){try{e.send()}catch(n){e.onerror()}},i=function(e,t){n.ctx.decodeAudioData(e,function(e){e&&t._sounds.length>0&&(r[t._src]=e,d(t,e))},function(){t._emit("loaderror",null,"Decoding audio data failed.")})},d=function(e,n){n&&!e._duration&&(e._duration=n.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},_=function(){try{"undefined"!=typeof AudioContext?n.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?n.ctx=new webkitAudioContext:n.usingWebAudio=!1}catch(e){n.usingWebAudio=!1}var e=/iP(hone|od|ad)/.test(n._navigator&&n._navigator.platform),t=n._navigator&&n._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),o=t?parseInt(t[1],10):null;if(e&&o&&o<9){var r=/safari/.test(n._navigator&&n._navigator.userAgent.toLowerCase());(n._navigator&&n._navigator.standalone&&!r||n._navigator&&!n._navigator.standalone&&!r)&&(n.usingWebAudio=!1)}n.usingWebAudio&&(n.masterGain=void 0===n.ctx.createGain?n.ctx.createGainNode():n.ctx.createGain(),n.masterGain.gain.setValueAtTime(n._muted?0:1,n.ctx.currentTime),n.masterGain.connect(n.ctx.destination)),n._setup()};"function"==typeof define&&define.amd&&define([],function(){return{Howler:n,Howl:t}}),"undefined"!=typeof exports&&(exports.Howler=n,exports.Howl=t),"undefined"!=typeof window?(window.HowlerGlobal=e,window.Howler=n,window.Howl=t,window.Sound=o):"undefined"!=typeof global&&(global.HowlerGlobal=e,global.Howler=n,global.Howl=t,global.Sound=o)}();"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var AppStore=function(){function AppStore(){_classCallCheck(this,AppStore);this.state={};this.listeners=[];this.methods={};window._store=this}_createClass(AppStore,[{key:"addListener",value:function addListener(obj,key){if(key){if(!this.methods[key])this.methods[key]=[];this.methods[key].push(obj)}else{this.listeners.push(obj)}}},{key:"removeListener",value:function removeListener(obj,key){if(key){if(this.methods[key]){var index=this.methods[key].indexOf(obj);if(index!==-1)this.methods[key].splice(index,1)}}else{var _index=this.listeners.indexOf(obj);if(_index!==-1)this.listeners.splice(_index,1)}}},{key:"set",value:function set(key,value){if(typeof key==="undefined")throw new Error("AppStore requires legit keys");this.state[key]=value;this.listeners.forEach(function(el,i,arr){el.storeUpdated(key,value)});var objs=this.methods[key];if(objs){objs.forEach(function(el){if(el[key])el[key](value);else throw new Error("AppStore listener has no callback: "+key)})}}},{key:"get",value:function get(key){return this.state[key]}},{key:"log",value:function log(){for(var key in _store.state){console.log(key,_store.state[key])}}}]);return AppStore}();"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var EasingFloat=function(){function EasingFloat(){var value=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var easeFactor=arguments.length>1&&arguments[1]!==undefined?arguments[1]:8;var completeRange=arguments.length>2&&arguments[2]!==undefined?arguments[2]:.001;_classCallCheck(this,EasingFloat);this.val=value;this.targetVal=value;this.easeFactor=easeFactor;this.completeRange=completeRange;this.speed=0}_createClass(EasingFloat,[{key:"setTarget",value:function setTarget(value){if(!isNaN(parseFloat(value)))this.targetVal=value}},{key:"setValue",value:function setValue(value){this.val=value}},{key:"setEaseFactor",value:function setEaseFactor(value){this.easeFactor=value}},{key:"value",value:function value(){return this.val}},{key:"target",value:function target(){return this.targetVal}},{key:"update",value:function update(){var accelerates=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(this.val==this.targetVal)return;if(accelerates==false){this.val+=(this.targetVal-this.val)/this.easeFactor}else{var increment=(this.targetVal-this.val)/this.easeFactor;if(Math.abs(increment)>Math.abs(this.speed)){this.speed+=increment/this.easeFactor;increment=this.speed}else{this.speed=increment}this.val+=increment}if(Math.abs(this.targetVal-this.val)<this.completeRange){this.val=this.targetVal}return this.val}},{key:"updateRadians",value:function updateRadians(){if(this.val==this.targetVal)return;var angleDifference=this.targetVal-this.val;var addToLoop=0;if(angleDifference>Math.PI){addToLoop=-EasingFloat.TWO_PI}else if(angleDifference<-Math.PI){addToLoop=EasingFloat.TWO_PI}this.val+=(this.targetVal-this.val+addToLoop)/this.easeFactor;if(Math.abs(this.val-this.targetVal)<this.completeRange){this.val=this.targetVal}}}]);return EasingFloat}();EasingFloat.TWO_PI=Math.PI*2;"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var EaseToValueCallback=function(){function EaseToValueCallback(){var value=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var easeFactor=arguments.length>1&&arguments[1]!==undefined?arguments[1]:10;var callback=arguments.length>2&&arguments[2]!==undefined?arguments[2]:EaseToValueCallback.noop;var finishRange=arguments.length>3&&arguments[3]!==undefined?arguments[3]:.01;_classCallCheck(this,EaseToValueCallback);if(typeof EasingFloat==="undefined")return console.warn("EaseToValueCallback requires EasingFloat");this.easingFloat=new EasingFloat(value,easeFactor);this.callback=callback;this.finishRange=finishRange}_createClass(EaseToValueCallback,[{key:"setTarget",value:function setTarget(value){this.easingFloat.setTarget(value);this.easeToTarget()}},{key:"setValue",value:function setValue(value){this.easingFloat.setValue(value)}},{key:"easeToTarget",value:function easeToTarget(){var _this=this;this.callback(this.easingFloat.update());if(Math.abs(this.easingFloat.value()-this.easingFloat.target())>this.finishRange){requestAnimationFrame(function(){_this.easeToTarget()})}else{this.easingFloat.setValue(this.easingFloat.target());this.callback(this.easingFloat.value())}}}]);return EaseToValueCallback}();EaseToValueCallback.noop=function(){};"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var ElasticFloat=function(){function ElasticFloat(){var value=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var fric=arguments.length>1&&arguments[1]!==undefined?arguments[1]:.8;var accel=arguments.length>2&&arguments[2]!==undefined?arguments[2]:.2;_classCallCheck(this,ElasticFloat);this.val=value;this.fric=fric;this.accel=accel;this.targetVal=this.val;this.speed=0}_createClass(ElasticFloat,[{key:"value",value:function value(){return this.val}},{key:"target",value:function target(){return this.targetVal}},{key:"setCurrent",value:function setCurrent(value){this.val=value}},{key:"setTarget",value:function setTarget(target){this.targetVal=target}},{key:"setFriction",value:function setFriction(fric){this.fric=fric}},{key:"setAccel",value:function setAccel(accel){this.accel=accel}},{key:"update",value:function update(){this.speed=((this.targetVal-this.val)*this.accel+this.speed)*this.fric;this.val+=this.speed;return this.val}}]);return ElasticFloat}();"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var LinearFloat=function(){function LinearFloat(){var value=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var inc=arguments.length>1&&arguments[1]!==undefined?arguments[1]:.025;_classCallCheck(this,LinearFloat);this.val=value;this.targetVal=value;this.inc=inc}_createClass(LinearFloat,[{key:"setValue",value:function setValue(value){this.val=value}},{key:"setTarget",value:function setTarget(value){this.targetVal=value}},{key:"setInc",value:function setInc(value){this.inc=value}},{key:"value",value:function value(){return this.val}},{key:"valuePenner",value:function valuePenner(equation){return equation(this.val,0,1,1)}},{key:"valueMapped",value:function valueMapped(min,max){return this.map(this.val,0,1,min,max)}},{key:"map",value:function map(val,inputMin,inputMax,outputMin,outputMax){return(outputMax-outputMin)*((val-inputMin)/(inputMax-inputMin))+outputMin}},{key:"target",value:function target(){return this.targetVal}},{key:"update",value:function update(){if(this.val!=this.targetVal){var reachedTarget=false;if(this.val<this.targetVal){this.val+=this.inc;if(this.val>this.targetVal)reachedTarget=true}else{this.val-=this.inc;if(this.val<this.targetVal)reachedTarget=true}if(reachedTarget==true){this.val=this.targetVal}}return this.val}}]);return LinearFloat}();"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Penner=function(){function Penner(){_classCallCheck(this,Penner)}_createClass(Penner,null,[{key:"easeInQuad",value:function easeInQuad(t,b,c,d){return c*(t/=d)*t+b}},{key:"easeOutQuad",value:function easeOutQuad(t,b,c,d){return-c*(t/=d)*(t-2)+b}},{key:"easeInOutQuad",value:function easeInOutQuad(t,b,c,d){if((t/=d/2)<1)return c/2*t*t+b;return-c/2*(--t*(t-2)-1)+b}},{key:"easeInCubic",value:function easeInCubic(t,b,c,d){return c*(t/=d)*t*t+b}},{key:"easeOutCubic",value:function easeOutCubic(t,b,c,d){return c*((t=t/d-1)*t*t+1)+b}},{key:"easeInOutCubic",value:function easeInOutCubic(t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t+b;return c/2*((t-=2)*t*t+2)+b}},{key:"easeInQuart",value:function easeInQuart(t,b,c,d){return c*(t/=d)*t*t*t+b}},{key:"easeOutQuart",value:function easeOutQuart(t,b,c,d){return-c*((t=t/d-1)*t*t*t-1)+b}},{key:"easeInOutQuart",value:function easeInOutQuart(t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t*t+b;return-c/2*((t-=2)*t*t*t-2)+b}},{key:"easeInQuint",value:function easeInQuint(t,b,c,d){return c*(t/=d)*t*t*t*t+b}},{key:"easeOutQuint",value:function easeOutQuint(t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b}},{key:"easeInOutQuint",value:function easeInOutQuint(t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t*t*t+b;return c/2*((t-=2)*t*t*t*t+2)+b}},{key:"easeInSine",value:function easeInSine(t,b,c,d){return-c*Math.cos(t/d*(Math.PI/2))+c+b}},{key:"easeOutSine",value:function easeOutSine(t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b}},{key:"easeInOutSine",value:function easeInOutSine(t,b,c,d){return-c/2*(Math.cos(Math.PI*t/d)-1)+b}},{key:"easeInExpo",value:function easeInExpo(t,b,c,d){return t==0?b:c*Math.pow(2,10*(t/d-1))+b}},{key:"easeOutExpo",value:function easeOutExpo(t,b,c,d){return t==d?b+c:c*(-Math.pow(2,-10*t/d)+1)+b}},{key:"easeInOutExpo",value:function easeInOutExpo(t,b,c,d){if(t==0)return b;if(t==d)return b+c;if((t/=d/2)<1)return c/2*Math.pow(2,10*(t-1))+b;return c/2*(-Math.pow(2,-10*--t)+2)+b}},{key:"easeInCirc",value:function easeInCirc(t,b,c,d){return-c*(Math.sqrt(1-(t/=d)*t)-1)+b}},{key:"easeOutCirc",value:function easeOutCirc(t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b}},{key:"easeInOutCirc",value:function easeInOutCirc(t,b,c,d){if((t/=d/2)<1)return-c/2*(Math.sqrt(1-t*t)-1)+b;return c/2*(Math.sqrt(1-(t-=2)*t)+1)+b}},{key:"easeInElastic",value:function easeInElastic(t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return-(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b}},{key:"easeOutElastic",value:function easeOutElastic(t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b}},{key:"easeInOutElastic",value:function easeInOutElastic(t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d/2)==2)return b+c;if(!p)p=d*(.3*1.5);if(a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);if(t<1)return-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b;return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b}},{key:"easeInBack",value:function easeInBack(t,b,c,d,s){if(s==undefined)s=1.70158;return c*(t/=d)*t*((s+1)*t-s)+b}},{key:"easeOutBack",value:function easeOutBack(t,b,c,d,s){if(s==undefined)s=1.70158;return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b}},{key:"easeInOutBack",value:function easeInOutBack(t,b,c,d,s){if(s==undefined)s=1.70158;if((t/=d/2)<1)return c/2*(t*t*(((s*=1.525)+1)*t-s))+b;return c/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+b}},{key:"easeOutBounce",value:function easeOutBounce(t,b,c,d){if((t/=d)<1/2.75){return c*(7.5625*t*t)+b}else if(t<2/2.75){return c*(7.5625*(t-=1.5/2.75)*t+.75)+b}else if(t<2.5/2.75){return c*(7.5625*(t-=2.25/2.75)*t+.9375)+b}else{return c*(7.5625*(t-=2.625/2.75)*t+.984375)+b}}}]);return Penner}();"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var PointerPos=function(){function PointerPos(){var _this=this;_classCallCheck(this,PointerPos);this.curX=-1;this.curY=-1;this.lastX=-1;this.lastY=-1;document.addEventListener("mousedown",function(e){_this.pointerMoved(e.clientX,e.clientY)});document.addEventListener("mousemove",function(e){_this.pointerMoved(e.clientX,e.clientY)});document.addEventListener("touchstart",function(e){_this.pointerMoved(e.touches[0].clientX,e.touches[0].clientY)});document.addEventListener("touchmove",function(e){_this.pointerMoved(e.touches[0].clientX,e.touches[0].clientY)})}_createClass(PointerPos,[{key:"reset",value:function reset(){this.curX=-1;this.curY=-1;this.lastX=-1;this.lastY=-1}},{key:"pointerMoved",value:function pointerMoved(x,y){this.lastX=this.curX;this.lastY=this.curY;this.curX=x;this.curY=y}},{key:"x",value:function x(){var el=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(el){var offset=el.getBoundingClientRect();return this.curX-offset.left}return this.curX}},{key:"y",value:function y(){var el=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(el){var offset=el.getBoundingClientRect();return this.curY-offset.top}return this.curY}},{key:"xPercent",value:function xPercent(el){if(el!=null){var offset=el.getBoundingClientRect();var relativeX=this.curX-offset.left;return relativeX/offset.width}return this.curX/window.innerWidth}},{key:"yPercent",value:function yPercent(el){if(el!=null){var offset=el.getBoundingClientRect();var relativeY=this.curY-offset.top;return relativeY/offset.height}return this.curY/window.innerHeight}},{key:"xDelta",value:function xDelta(){return this.lastX==-1?0:this.curX-this.lastX}},{key:"yDelta",value:function yDelta(){return this.lastY==-1?0:this.curY-this.lastY}}]);return PointerPos}();"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var DOMUtil=function(){function DOMUtil(){_classCallCheck(this,DOMUtil)}_createClass(DOMUtil,null,[{key:"closest",value:function closest(element,selector){selector=selector.toLowerCase();var className=selector.split(".").length>1?selector.split(".")[1]:"";selector=selector.split(".")[0];while(true){if(element.nodeName.toLowerCase()===selector&&element.className.indexOf(className)!==-1){return element}if(!(element=element.parentNode)){break}}return null}},{key:"remove",value:function remove(el){if(el&&el.parentNode){return el.parentNode.removeChild(el)}return null}},{key:"stringToDomElement",value:function stringToDomElement(str){var div=document.createElement("div");div.innerHTML=str;return div.firstChild}},{key:"elementToString",value:function elementToString(el){return el.outerHTML}},{key:"addLoadedClass",value:function addLoadedClass(){window.addEventListener("load",function(e){setTimeout(function(){document.body.classList.add("ready")},1e3)})}},{key:"isElementVisible",value:function isElementVisible(el){var rect=el.getBoundingClientRect();return rect.bottom>0&&rect.right>0&&rect.left<(window.innerWidth||document.documentElement.clientWidth)&&rect.top<(window.innerHeight||document.documentElement.clientHeight)}}]);return DOMUtil}();"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var PageVisibility=function(){function PageVisibility(activeCallback,inactiveCallback){_classCallCheck(this,PageVisibility);this.activeCallback=activeCallback||null;this.inactiveCallback=inactiveCallback||null;this.getPrefix();this.initPageVisibilityApi()}_createClass(PageVisibility,[{key:"getPrefix",value:function getPrefix(){this.prefix=null;if(document.hidden!==undefined)this.prefix="";else{var browserPrefixes=["webkit","moz","ms","o"];for(var i=0;i<browserPrefixes.length;i++){if(document[browserPrefixes[i]+"Hidden"]!=undefined){this.prefix=browserPrefixes[i];break}}}}},{key:"updateState",value:function updateState(e){if(document.hidden===false||document[this.prefix+"Hidden"]===false){if(this.activeCallback!=null)this.activeCallback()}else{if(this.inactiveCallback!=null)this.inactiveCallback()}}},{key:"initPageVisibilityApi",value:function initPageVisibilityApi(){var _this=this;if(this.prefix===null)console.log("Your browser does not support Page Visibility API");else{document.addEventListener(this.prefix+"visibilitychange",function(e){return _this.updateState(e)})}}}]);return PageVisibility}();"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var CanvasUtil=function(){function CanvasUtil(){_classCallCheck(this,CanvasUtil)}_createClass(CanvasUtil,null,[{key:"hasCanvas",value:function hasCanvas(){return!document.createElement("canvas").getContext?false:true}},{key:"getCanvasContext",value:function getCanvasContext(canvas){return canvas.getContext("2d")}},{key:"hex2rgb",value:function hex2rgb(hexColor){hexColor=hexColor.replace("#","");return{r:parseInt(hexColor.substring(0,2),16),g:parseInt(hexColor.substring(2,4),16),b:parseInt(hexColor.substring(4,6),16)}}},{key:"drawCircle",value:function drawCircle(ctx,x,y,radius,extraSetup){ctx.save();if(extraSetup)extraSetup(ctx);ctx.beginPath();ctx.arc(x,y,radius,0,2*Math.PI,false);ctx.closePath();ctx.stroke();ctx.fill();ctx.restore()}},{key:"drawArc",value:function drawArc(ctx,x,y,radius,startRads,endRads){var centered=arguments.length>6&&arguments[6]!==undefined?arguments[6]:true;var connectCenter=arguments.length>7&&arguments[7]!==undefined?arguments[7]:false;ctx.save();ctx.beginPath();if(centered)ctx.moveTo(x,y);ctx.arc(x,y,radius,startRads,endRads,connectCenter);ctx.closePath();ctx.stroke();ctx.fill();ctx.restore()}}]);return CanvasUtil}();CanvasUtil.clearColor="rgba(0,0,0,0)";CanvasUtil.dataImgPrefix="data:image/png;base64,";"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var VideoSphere=function(){function VideoSphere(){_classCallCheck(this,VideoSphere);this.scene=_store.get(Proceeds.THREE_SCENE);_store.addListener(this);this.mesh=null;this.photoTexture=null;this.videoTexture=null;this.isVideo=false;this.videoProgressTracking=0;this.targetColor=new THREE.Color(16777215);this.buildSphere();this.buildVideoTexture();this.loadInitialMedia()}_createClass(VideoSphere,[{key:"storeUpdated",value:function storeUpdated(key,value){if(key==Proceeds.REQUEST_ANIMATION_FRAME)this.update();if(key==Proceeds.CUR_PATH_UPDATED)this.stopVideo();if(key==Proceeds.CURRENT_360_IMAGE)this.loadPhoto(value);if(key==Proceeds.CURRENT_360_VIDEO)this.loadVideo(value);if(key==Proceeds.CONTROL_MODE)this.updateControlMode();if(key==Proceeds.AUDIO_MUTED)this.toggleMute(value);if(key==Proceeds.LOADER_HIDDEN){if(this.nextTexture){this.showPhoto()}else{this.showVideo()}}if(key==Proceeds.GAME_STREAK){this.targetColor.setHex(this.hexStringToNumberColor(_store.get(Proceeds.POINT_COLOR)))}if(key==Proceeds.GAME_TIMER_RUNNING_OUT)this.mesh.material.color.setHex(14493979)}},{key:"hexStringToNumberColor",value:function hexStringToNumberColor(hexStr){return Number("0x"+hexStr.replace("#",""))}},{key:"loadInitialMedia",value:function loadInitialMedia(){_store.set(Proceeds.VIDEO_BUFFERING,false);if(_store.get(Proceeds.CURRENT_360_IMAGE))this.loadPhoto(_store.get(Proceeds.CURRENT_360_IMAGE));if(_store.get(Proceeds.CURRENT_360_VIDEO))this.loadVideo(_store.get(Proceeds.CURRENT_360_VIDEO))}},{key:"buildSphere",value:function buildSphere(){this.sphereGeometry=new THREE.SphereGeometry(Config.VIDEO_SPHERE_SIZE,64,64);this.sphereGeometry.scale(-1,1,1);this.buildSphereMesh()}},{key:"buildVideoTexture",value:function buildVideoTexture(){var _this=this;this.videoEl=document.createElement("video");if(AFRAME.utils.device.isMobile()||!AFRAME.utils.device.isMobile())this.videoEl.setAttribute("muted","muted");this.videoEl.setAttribute("playsinline","playsinline");this.videoEl.setAttribute("width","2048");this.videoEl.setAttribute("height","1024");this.videoEl.addEventListener("ended",function(e){return _this.videoEnded(e)});this.videoEl.addEventListener("timeupdate",function(e){return _this.videoTimeUpdate(e)});this.videoEl.addEventListener("progress",function(e){return _this.videoTimeUpdate(e)});this.videoTexture=new THREE.VideoTexture(this.videoEl);this.videoTexture.minFilter=THREE.LinearFilter;this.videoTexture.magFilter=THREE.LinearFilter;this.videoTexture.format=THREE.RGBFormat}},{key:"buildSphereMesh",value:function buildSphereMesh(){var material=new THREE.MeshBasicMaterial({side:THREE.FrontSide,color:16777215});this.mesh=new THREE.Mesh(this.sphereGeometry,material);this.mesh.position.y=Config.BASE_Y;this.scene.add(this.mesh);this.updateControlMode()}},{key:"updateControlMode",value:function updateControlMode(){switch(_store.get(Proceeds.CONTROL_MODE)){case Proceeds.CONTROL_MODE_DESKTOP:this.mesh.rotation.y=Config.SPHERE_ROTATION_DESKTOP;break;default:this.mesh.rotation.y=Config.SPHERE_ROTATION_VR}}},{key:"toggleMute",value:function toggleMute(muted){this.videoEl.muted=muted;if(muted==true){this.videoEl.setAttribute("muted","muted")}else{this.videoEl.removeAttribute("muted")}}},{key:"videoEnded",value:function videoEnded(e){_store.set(Proceeds.VIDEO_BUFFERING,false);this.clearBufferingTimer();
if(_store.get(Proceeds.FIRST_PATH)!="home"){
	_store.set(Proceeds.GO_BACK,true)
}else{
	if(_store.get(Proceeds.AUTOPLAY_ALL_VIDEOS)!=true){
		_store.set(Proceeds.SHOW_3D_MENU,true);
		_store.set(Proceeds.VIDEO_FINISHED,true)
	}
	if(_store.get(Proceeds.VR_ACTIVE)==false){
		_store.set(Proceeds.NAVIGATION_PATH,"home");
		_store.set(Proceeds.SHOW_HOME_VIDEO_MENU,true)
	}else{
		if(_store.get(Proceeds.AUTOPLAY_ALL_VIDEOS)==true){
			if(_store.get(Proceeds.CUR_PATH_UPDATED)=="biking")
				_store.set(Proceeds.NAVIGATION_PATH,"climbing");
			else if(_store.get(Proceeds.CUR_PATH_UPDATED)=="climbing")
				_store.set(Proceeds.NAVIGATION_PATH,"skiing");
			else if(_store.get(Proceeds.CUR_PATH_UPDATED)=="skiing")
				_store.set(Proceeds.NAVIGATION_PATH,"mustang")
			else if(_store.get(Proceeds.CUR_PATH_UPDATED)=="mustang")
				_store.set(Proceeds.NAVIGATION_PATH,"ouray")
			else if(_store.get(Proceeds.CUR_PATH_UPDATED)=="ouray")
				_store.set(Proceeds.NAVIGATION_PATH,"home")
		}
	}
}
}
},{key:"videoTimeUpdate",value:function videoTimeUpdate(e){if(this.isVideo==false)return;var newProgress=this.videoEl.currentTime/this.videoEl.duration;if(newProgress>this.videoProgress){this.setBufferingTimer()}this.videoProgress=newProgress;if(this.videoProgress>.001&&_store.get(Proceeds.LOADING_360_TEXTURE)==true){_store.set(Proceeds.LOADING_360_TEXTURE,false)}if(this.videoProgressTracking==0&&this.videoProgress>.25){this.videoProgressTracking=.25;_store.set(Proceeds.VIDEO_PROGRESS_25,true)}if(this.videoProgressTracking==.25&&this.videoProgress>.5){this.videoProgressTracking=.5;_store.set(Proceeds.VIDEO_PROGRESS_50,true)}if(this.videoProgressTracking==.5&&this.videoProgress>.75){this.videoProgressTracking=.75;_store.set(Proceeds.VIDEO_PROGRESS_75,true)}if(this.videoEl.currentTime>.5&&this.videoEl.currentTime<3){_store.set(Proceeds.SHOW_VIDEO_INTRO_TEXT,true)}else if(this.videoEl.currentTime>5.5&&this.videoEl.currentTime<8){_store.set(Proceeds.SHOW_VIDEO_INTRO_TEXT,false)}if(this.videoProgress>.8&&this.videoProgress<.84){_store.set(Proceeds.SHOW_VIDEO_OUTRO_TEXT,true)}else if(this.videoProgress>.975){_store.set(Proceeds.SHOW_VIDEO_OUTRO_TEXT,false)}}},{key:"loadPhoto",value:function loadPhoto(img){var _this2=this;this.isVideo=false;_store.set(Proceeds.LOADING_360_TEXTURE,true);this.clearBufferingTimer();var loader=new THREE.TextureLoader;loader.load(img,function(texture){_this2.nextTexture=texture;_store.set(Proceeds.LOADING_360_TEXTURE,false)})}},{key:"showPhoto",value:function showPhoto(){this.videoEl.removeAttribute("src");this.mesh.material.visible=true;this.mesh.material.map=this.nextTexture;this.mesh.material.needsUpdate=true;this.clearBufferingTimer()}},{key:"loadVideo",value:function loadVideo(src){var _this3=this;this.isVideo=true;_store.set(Proceeds.LOADING_360_TEXTURE,true);this.nextTexture=null;setTimeout(function(el,i){_this3.videoEl.setAttribute("src",src);_this3.videoEl.setAttribute("autoplay",true);_this3.videoEl.play();_this3.videoEl.playbackRate=Config.VIDEO_RATE;_this3.videoProgressTracking=0},50)}},{key:"showVideo",value:function showVideo(){this.mesh.material.map=this.videoTexture;this.mesh.material.needsUpdate=true}},{key:"setBufferingTimer",value:function setBufferingTimer(){var _this4=this;this.clearBufferingTimer();this.bufferTimer=setTimeout(function(){if(_this4.isVideo){_store.set(Proceeds.VIDEO_BUFFERING,true)}},1e3)}},{key:"clearBufferingTimer",value:function clearBufferingTimer(){if(_store.get(Proceeds.VIDEO_BUFFERING)==true)_store.set(Proceeds.VIDEO_BUFFERING,false);clearTimeout(this.bufferTimer)}},{key:"stopVideo",value:function stopVideo(){if(this.videoEl)this.videoEl.pause()}},{key:"update",value:function update(){this.mesh.material.color.lerp(this.targetColor,.025);this.mesh.material.needsUpdate=true}}]);return VideoSphere}();"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var VideoText=function(){function VideoText(img){_classCallCheck(this,VideoText);this.img=img;this.scene=_store.get(Proceeds.THREE_SCENE);_store.addListener(this);this.scaleShow=new LinearFloat(0,.04);var height=Config.VIDEO_TEXT_HEIGHT;var aspect=8/1;if(this.img==Config.VIDEO_LOTTERY_LOGO){aspect=1}this.buildMesh(height*aspect,height);this.loadTextureImage(img)}_createClass(VideoText,[{key:"loadTextureImage",value:function loadTextureImage(img){var _this=this;(new THREE.TextureLoader).load(img,function(texture){_this.mesh.material.map=texture;_this.mesh.material.needsUpdate=true})}},{key:"storeUpdated",value:function storeUpdated(key,value){if(key==Proceeds.CONTROL_MODE)this.updateControlMode();if(key==Proceeds.REQUEST_ANIMATION_FRAME)this.update();
if(key==Proceeds.CUR_PATH_UPDATED)this.hide();
if(key==Proceeds.SHOW_VIDEO_INTRO_TEXT&&(this.img==Config.VIDEO_INTRO_TEXT_IMG||this.img==Config.VIDEO_LOTTERY_LOGO)){
	if(value==true)
		this.show();
	else
		this.hide()
}
if(key==Proceeds.SHOW_VIDEO_OUTRO_TEXT&&this.img==Config.VIDEO_BIKING_TEXT_IMG&&_store.get(Proceeds.CUR_PATH_UPDATED).indexOf("biking")!=-1){
	if(value==true)
		this.show();
	else this.hide()
}
if(key==Proceeds.SHOW_VIDEO_OUTRO_TEXT&&this.img==Config.VIDEO_CLIMBING_TEXT_IMG&&_store.get(Proceeds.CUR_PATH_UPDATED).indexOf("climbing")!=-1){
	if(value==true)
		this.show();
	else
		this.hide()
}
if(key==Proceeds.SHOW_VIDEO_OUTRO_TEXT&&this.img==Config.VIDEO_SKIING_TEXT_IMG&&_store.get(Proceeds.CUR_PATH_UPDATED).indexOf("skiing")!=-1){
	if(value==true)
		this.show();
	else this.hide()
}
if(key==Proceeds.SHOW_VIDEO_OUTRO_TEXT&&this.img==Config.VIDEO_MUSTANG_TEXT_IMG&&_store.get(Proceeds.CUR_PATH_UPDATED).indexOf("mustang")!=-1){
	if(value==true)
		this.show();
	else this.hide()
}
if(key==Proceeds.SHOW_VIDEO_OUTRO_TEXT&&this.img==Config.VIDEO_MUSTANG_TEXT_IMG&&_store.get(Proceeds.CUR_PATH_UPDATED).indexOf("ouray")!=-1){
	if(value==true)
		this.show();
	else this.hide()
}
if(key==Proceeds.SHOW_VIDEO_OUTRO_TEXT||key==Proceeds.SHOW_VIDEO_INTRO_TEXT){if(this.img==Config.VIDEO_LOTTERY_LOGO){
	if(value==true)
		this.show();
	else
		this.hide()
}}}},{key:"updateControlMode",value:function updateControlMode(){this.rotationY=_store.get(Proceeds.CONTROL_MODE)==Proceeds.CONTROL_MODE_DESKTOP?0:Config.BUTTONS_ROT_OFFSET;
	if(_store.get(Proceeds.SHOW_VIDEO_OUTRO_TEXT)==true){
		if(_store.get(Proceeds.CUR_PATH_UPDATED).indexOf("climbing")!=-1){
			if(this.img==Config.VIDEO_CLIMBING_TEXT_IMG||this.img==Config.VIDEO_LOTTERY_LOGO)
				this.rotationY+=.7
		}
		if(_store.get(Proceeds.CUR_PATH_UPDATED).indexOf("biking")!=-1){
			if(this.img==Config.VIDEO_BIKING_TEXT_IMG||this.img==Config.VIDEO_LOTTERY_LOGO)
				this.rotationY+=1.4
		}
		if(_store.get(Proceeds.CUR_PATH_UPDATED).indexOf("skiing")!=-1){
			if(this.img==Config.VIDEO_LOTTERY_LOGO)
				this.rotationY+=1.4;
			if(this.img==Config.VIDEO_SKIING_TEXT_IMG)
				this.rotationY-=.7
		}
		if(_store.get(Proceeds.CUR_PATH_UPDATED).indexOf("mustang")!=-1){
			if(this.img==Config.VIDEO_LOTTERY_LOGO)
				this.rotationY+=1.4;
			if(this.img==Config.VIDEO_MUSTANG_TEXT_IMG)
				this.rotationY-=.7
		}
		if(_store.get(Proceeds.CUR_PATH_UPDATED).indexOf("ouray")!=-1){
			if(this.img==Config.VIDEO_LOTTERY_LOGO)
				this.rotationY+=1.4;
			if(this.img==Config.VIDEO_OURAY_TEXT_IMG)
				this.rotationY-=.7
		}
	}
	var y=Config.VIDEO_TEXT_Y;
	if(this.img==Config.VIDEO_LOTTERY_LOGO)y-=2.5;
	if(_store.get(Proceeds.SHOW_VIDEO_OUTRO_TEXT)==true)y+=3;
	this.setPosition(Config.INSTRUCTIONS_PLANE_DISTANCE*Math.cos(this.rotationY),y,Config.INSTRUCTIONS_PLANE_DISTANCE*Math.sin(this.rotationY))}},{key:"setPosition",value:function setPosition(x,y,z){this.mesh.position.set(x,y,z);this.mesh.lookAt(Config.BASE_Y_CAMERA)}},{key:"buildMesh",value:function buildMesh(width,height){var geometry=new THREE.PlaneGeometry(width,height);this.material=new THREE.MeshBasicMaterial({color:16777215,side:THREE.FrontSide,transparent:true,alphaTest:.05});this.mesh=new THREE.Mesh(geometry,this.material);this.mesh.visible=false;this.scene.add(this.mesh);this.updateControlMode()}},{key:"update",value:function update(){this.scaleShow.update();if(this.mesh.visible==true&&this.scaleShow.value()==0)this.mesh.visible=false;var curScale=Math.max(1e-5,this.scaleShow.valuePenner(Penner.easeInOutQuad));this.material.opacity=curScale}},{key:"show",value:function show(){this.updateControlMode();this.scaleShow.setTarget(1);this.mesh.visible=true}},{key:"hide",value:function hide(){this.scaleShow.setTarget(0)}}]);return VideoText}();
var VideoTexts=function VideoTexts(){
	_classCallCheck(this,VideoTexts);
	this.introText=new VideoText(Config.VIDEO_INTRO_TEXT_IMG);
	this.bikingText=new VideoText(Config.VIDEO_BIKING_TEXT_IMG);
	this.climbingText=new VideoText(Config.VIDEO_CLIMBING_TEXT_IMG);
	this.skiingText=new VideoText(Config.VIDEO_SKIING_TEXT_IMG);
	this.mustangText=new VideoText(Config.VIDEO_MUSTANG_TEXT_IMG);
	this.ourayText=new VideoText(Config.VIDEO_OURAY_TEXT_IMG);
	this.lotteryLogo=new VideoText(Config.VIDEO_LOTTERY_LOGO)
};"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var SpatialArrow=function(){function SpatialArrow(texture){_classCallCheck(this,SpatialArrow);this.scene=_store.get(Proceeds.THREE_SCENE);this.scaleShow=new LinearFloat(0,.04);this.baseRotation=0;this.flipped=false;var height=1.5;var aspect=752/514;this.buildMesh(height*aspect,height,texture)}_createClass(SpatialArrow,[{key:"buildMesh",value:function buildMesh(width,height,texture){var geometry=new THREE.PlaneGeometry(width,height);this.material=new THREE.MeshBasicMaterial({color:16777215,side:THREE.DoubleSide,transparent:true,alphaTest:.05,map:texture});this.mesh=new THREE.Mesh(geometry,this.material);this.mesh.visible=false;this.scene.add(this.mesh)}},{key:"update",value:function update(){this.scaleShow.update();if(this.mesh.visible==true&&this.scaleShow.value()==0)this.mesh.visible=false;var curScale=Math.max(1e-5,this.scaleShow.valuePenner(Penner.easeInOutQuad));if(curScale>.2)curScale*=1+.1*Math.sin(this.mesh.position.z+Date.now()*.01);var scaleX=this.flipped?-curScale:curScale;this.mesh.scale.set(scaleX,curScale,curScale);this.material.opacity=curScale}},{key:"setPosition",value:function setPosition(baseRotation,rotY){this.baseRotation=baseRotation;this.mesh.position.set(Config.ARROWS_DISTANCE*Math.cos(this.baseRotation+rotY),Config.ARROWS_Y,Config.ARROWS_DISTANCE*Math.sin(this.baseRotation+rotY));if(rotY>0)this.flipped=true;this.mesh.lookAt(Config.BASE_Y_CAMERA)}},{key:"show",value:function show(){this.scaleShow.setTarget(1);this.mesh.visible=true}},{key:"hide",value:function hide(){this.scaleShow.setTarget(0)}}]);return SpatialArrow}();var SpatialText=function(){function SpatialText(texture){_classCallCheck(this,SpatialText);this.scene=_store.get(Proceeds.THREE_SCENE);this.scaleShow=new LinearFloat(0,.04);this.baseRotation=0;var height=1;var aspect=452/70;this.buildMesh(height*aspect,height,texture)}_createClass(SpatialText,[{key:"buildMesh",value:function buildMesh(width,height,texture){var geometry=new THREE.PlaneGeometry(width,height);this.material=new THREE.MeshBasicMaterial({color:16777215,side:THREE.FrontSide,transparent:true,alphaTest:.05,map:texture});this.mesh=new THREE.Mesh(geometry,this.material);this.mesh.visible=false;this.scene.add(this.mesh)}},{key:"update",value:function update(){this.scaleShow.update();if(this.mesh.visible==true&&this.scaleShow.value()==0)this.mesh.visible=false;var curScale=Math.max(1e-5,this.scaleShow.valuePenner(Penner.easeInOutQuad));this.mesh.scale.set(curScale,curScale,curScale);this.material.opacity=curScale}},{key:"setPosition",value:function setPosition(baseRotation){this.baseRotation=baseRotation;this.mesh.position.set(Config.LOOK_UP_DISTANCE*Math.cos(this.baseRotation),Config.LOOK_UP_Y,Config.LOOK_UP_DISTANCE*Math.sin(this.baseRotation));this.mesh.lookAt(Config.BASE_Y_CAMERA)}},{key:"show",value:function show(){this.scaleShow.setTarget(1);this.mesh.visible=true}},{key:"hide",value:function hide(){this.scaleShow.setTarget(0)}}]);return SpatialText}();var SpatialArrows=function(){function SpatialArrows(img){_classCallCheck(this,SpatialArrows);this.loaded=false;this.scene=_store.get(Proceeds.THREE_SCENE);_store.addListener(this);this.loadTextureImage(Config.ARROW_IMG);this.loadTextImage(Config.LOOK_UP_IMG)}_createClass(SpatialArrows,[{key:"loadTextureImage",value:function loadTextureImage(img){var _this=this;(new THREE.TextureLoader).load(img,function(texture){_this.buildArrows(texture);_this.checkAllLoaded()})}},{key:"loadTextImage",value:function loadTextImage(img){var _this2=this;(new THREE.TextureLoader).load(img,function(texture){_this2.lookUpText=new SpatialText(texture);_this2.checkAllLoaded()})}},{key:"buildArrows",value:function buildArrows(texture){this.arrows=[new SpatialArrow(texture),new SpatialArrow(texture),new SpatialArrow(texture),new SpatialArrow(texture),new SpatialArrow(texture),new SpatialArrow(texture)]}},{key:"checkAllLoaded",value:function checkAllLoaded(){if(this.lookUpText&&this.arrows){this.loaded=true;this.updatePositions()}}},{key:"storeUpdated",value:function storeUpdated(key,value){if(key==Proceeds.CONTROL_MODE)this.updatePositions();if(key==Proceeds.REQUEST_ANIMATION_FRAME)this.update();if(key==Proceeds.CUR_PATH_UPDATED){var isHome=value.indexOf("home")!==-1;var isHeadset=_store.get(Proceeds.VR_ACTIVE);if(isHome&&!isHeadset){this.hide()}else{this.show()}}if(key==Proceeds.VIDEO_FINISHED){if(_store.get(Proceeds.VR_ACTIVE)==true){this.show()}}if(key==Proceeds.SHOW_VIDEO_INTRO_TEXT){if(value==false)this.hide()}if(key==Proceeds.GAME_ACTIVE){if(value==false)this.show();if(value==true)this.hide()}}},{key:"updatePositions",value:function updatePositions(){if(!this.loaded)return;this.baseRotation=_store.get(Proceeds.CONTROL_MODE)==Proceeds.CONTROL_MODE_DESKTOP?0:Config.BUTTONS_ROT_OFFSET;var incrementRads=Math.PI/5;var startRads=Math.PI/4;this.arrows[0].setPosition(this.baseRotation,-startRads-incrementRads*1);this.arrows[1].setPosition(this.baseRotation,-startRads-incrementRads*2);this.arrows[2].setPosition(this.baseRotation,-startRads-incrementRads*3);this.arrows[3].setPosition(this.baseRotation,startRads+incrementRads*1);this.arrows[4].setPosition(this.baseRotation,startRads+incrementRads*2);this.arrows[5].setPosition(this.baseRotation,startRads+incrementRads*3);this.lookUpText.setPosition(this.baseRotation)}},{key:"update",value:function update(){if(!this.loaded)return;this.lookUpText.update();this.arrows.forEach(function(el,i){el.update()})}},{key:"show",value:function show(){var _this3=this;if(!this.loaded)return;this.updatePositions();this.showTimeout=setTimeout(function(){_this3.lookUpText.show();_this3.arrows.forEach(function(el,i){el.show()})},1250)}},{key:"hide",value:function hide(){if(!this.loaded)return;window.clearTimeout(this.showTimeout);this.lookUpText.hide();this.arrows.forEach(function(el,i){el.hide()})}}]);return SpatialArrows}();"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var OrbitControls=function(){function OrbitControls(){_classCallCheck(this,OrbitControls);this.dragX=new EasingFloat(0,14);this.dragY=new EasingFloat(0,14);this.target=new THREE.Vector3}_createClass(OrbitControls,[{key:"clamp",value:function clamp(val,min,max){return Math.max(min,Math.min(max,val))}},{key:"update",value:function update(camera,userX,userY){if(_store.get(Proceeds.THREE_PAUSED)==true)return;this.dragX.setTarget(userX);this.dragY.setTarget(userY);this.dragX.update(true);this.dragY.update(true);var phi=THREE.Math.degToRad(90+this.dragY.value());var theta=THREE.Math.degToRad(this.dragX.value());this.target.x=Math.sin(phi)*Math.cos(theta);this.target.y=Math.cos(phi);this.target.z=Math.sin(phi)*Math.sin(theta);camera.lookAt(this.target)}},{key:"reset",value:function reset(camera,userX,userY){this.target.set(0,0,0);camera.lookAt(this.target)}}]);return OrbitControls}();"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var GameSphere=function(){function GameSphere(){_classCallCheck(this,GameSphere);this.scene=_store.get(Proceeds.THREE_SCENE);_store.addListener(this);this.active=false;this.hit=false;this.scale=new ElasticFloat(0);this.hitScale=new LinearFloat(0,.075);this.yOffset=0;this.radiusOffset=0;this.radiansOffset=0;this.launchTime=-1;this.colors=["#DBA81B","#E98024","#01A5DC","#8BB331","#563281"];this.buildCanvas();this.buildCanvasTexture();this.buildMesh();this.clickableObj=new Clickable(this,this.mesh,null,this.hover.bind(this),this.leave.bind(this))}_createClass(GameSphere,[{key:"reset",value:function reset(){}},{key:"storeUpdated",value:function storeUpdated(key,value){if(key==Proceeds.REQUEST_ANIMATION_FRAME)this.update();if(key==Proceeds.GAME_ACTIVE&&value==false){if(this.hit==false)this.shrinkNotHit()}}},{key:"randomColor",value:function randomColor(){var index=Math.min(Math.floor(Math.random()*(this.colors.length-1)),this.colors.length-1);return this.colors[index]}},{key:"update",value:function update(){if(this.active==false)return;this.scale.update();this.hitScale.update();this.setMeshPositionScale();if(this.hit==false&&Date.now()>this.launchTime+GameSphere.ALIVE_TIME)this.shrinkNotHit();if(this.hit==true){this.material.opacity=1-this.hitScale.value();if(Math.abs(this.hitScale.value())>=1){this.hit=false;this.remove()}}}},{key:"shrinkNotHit",value:function shrinkNotHit(){this.hit=true;this.hitScale.setTarget(-1)}},{key:"setMeshPositionScale",value:function setMeshPositionScale(){var curScale=Math.max(1e-4,this.scale.value()+this.hitScale.value());this.mesh.scale.set(curScale,curScale,curScale);if(this.scale.value()==0||this.hitScale.value()==1)this.mesh.visible=false;else this.mesh.visible=true;this.mesh.position.set(Config.GAME_SPHERE_RADIUS*this.radiusOffset*Math.cos(this.radiansOffset),Config.GAME_SPHERE_Y_RANGE*this.yOffset+.2*Math.sin(this.radiansOffset*3+Date.now()/300),Config.GAME_SPHERE_RADIUS*this.radiusOffset*Math.sin(this.radiansOffset));this.mesh.lookAt(Config.BASE_Y_CAMERA)}},{key:"click",value:function click(){this.hide()}},{key:"hover",value:function hover(){if(_store.get(Proceeds.GAME_ACTIVE)==false)return;if(this.scale.value()<.9)return;if(this.hit==true)return;this.hitScale.setTarget(1);this.hit=true;_store.set(Proceeds.PLAY_SOUND,Config.SOUNDS.POP);var curPoints=_store.get(Proceeds.GAME_POINTS);var streakMult=1+_store.get(Proceeds.GAME_STREAK);_store.set(Proceeds.POINT_COLOR,this.colorHex);_store.set(Proceeds.POINT_RADS,this.radiansOffset);_store.set(Proceeds.POINT_POSITION,this.mesh.position);_store.set(Proceeds.GAME_POINTS,curPoints+this.pointValue*streakMult)}},{key:"leave",value:function leave(){}},{key:"add",value:function add(rads,yOffset,radiusOffset,index){this.index=index;this.active=true;this.hit=false;this.pointValue=Math.ceil(.01+Math.random()*4.98);this.radiansOffset=rads;this.yOffset=yOffset;this.radiusOffset=radiusOffset;this.scale.setCurrent(0);this.scale.setTarget(1);this.hitScale.setValue(0);this.hitScale.setTarget(0);this.material.opacity=1;this.launchTime=Date.now();this.updateTexture();this.scene.add(this.mesh);this.mesh.visible=true;this.setMeshPositionScale();_store.set(Proceeds.ADD_CLICKABLE,this.clickableObj)}},{key:"remove",value:function remove(){this.active=false;this.hit=false;this.scene.remove(this.mesh);_store.set(Proceeds.REMOVE_CLICKABLE,this.clickableObj)}},{key:"updateTexture",value:function updateTexture(){this.colorHex=this.colors[this.index%this.colors.length];this.context.clearRect(0,0,this.canvas.width,this.canvas.height);this.drawBgCircle();this.drawPoints();this.canvasTexture.needsUpdate=true}},{key:"buildCanvas",value:function buildCanvas(){this.canvas=document.createElement("canvas");this.canvas.width=128;this.canvas.height=128;this.context=this.canvas.getContext("2d")}},{key:"buildCanvasTexture",value:function buildCanvasTexture(){this.canvasTexture=new THREE.Texture(this.canvas);this.material=new THREE.MeshBasicMaterial({map:this.canvasTexture,side:THREE.FrontSide,transparent:true,alphaTest:.3})}},{key:"buildMesh",value:function buildMesh(){this.mesh=new THREE.Mesh(new THREE.PlaneGeometry(1,1),this.material)}},{key:"drawBgCircle",value:function drawBgCircle(){var center=this.canvas.width*.5;var radius=center;this.context.lineWidth=0;this.context.strokeStyle="rgba(255, 255, 255, 0)";this.context.fillStyle=this.colorHex;CanvasUtil.drawArc(this.context,center,center,radius,0,Math.PI*2)}},{key:"drawPoints",value:function drawPoints(){var center=this.canvas.width*.5;this.context.font="60px FSEmeric-Bold";this.context.fillStyle="#ffffff";this.context.textAlign="center";this.context.textBaseline="bottom";this.context.shadowColor="rgba(0,0,0,0.5)";this.context.shadowOffsetX=0;this.context.shadowOffsetY=3;this.context.shadowBlur=6;this.context.fillText(this.pointValue,center,center+36);this.context.shadowColor="rgba(0,0,0,0)";this.context.shadowBlur=0}}]);return GameSphere}();GameSphere.ALIVE_TIME=4500;"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Clickable=function Clickable(object,mesh,click,hover,leave){_classCallCheck(this,Clickable);this.object=object;this.mesh=mesh;this.click=click;this.hover=hover;this.leave=leave};"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Cursor=function(){function Cursor(){var _this=this;_classCallCheck(this,Cursor);this.scene=_store.get(Proceeds.THREE_SCENE);_store.addListener(this);this.camera=null;this.clickables=[];this.buildCursor();this.setCamera(_store.get(Proceeds.THREE_CAMERA));document.body.addEventListener("click",function(e){return _this.checkMouseClick(e)})}_createClass(Cursor,[{key:"buildCursor",value:function buildCursor(){this.initScale();this.initHoverAbility();this.buildCanvas();this.buildCanvasTexture();this.vrStateChanged(_store.get(Proceeds.VR_ACTIVE))}},{key:"initScale",value:function initScale(){this.hiddenScale=.001;this.scale=new EasingFloat(this.hiddenScale,4);this.innerScaleSmall=.2;this.innerScaleLarge=.6;this.scaleInner=new EasingFloat(this.innerScaleSmall,4)}},{key:"initHoverAbility",value:function initHoverAbility(){this.raycaster=new THREE.Raycaster;this.mouse=new THREE.Vector2(0,0);this.hoveredClickable=null;this.hoverTimeout=null;Config.HOVER_TIME=1500;this.hoverStartTime=0}},{key:"buildCanvas",value:function buildCanvas(){this.canvas=document.createElement("canvas");this.canvas.width=256;this.canvas.height=256;this.context=this.canvas.getContext("2d")}},{key:"buildCanvasTexture",value:function buildCanvasTexture(){this.canvasTexture=new THREE.Texture(this.canvas);this.canvasTexture.needsUpdate=true;var material=new THREE.MeshBasicMaterial({map:this.canvasTexture,side:THREE.FrontSide,transparent:true,alphaTest:.3});var planeSize=.3;this.mesh=new THREE.Mesh(new THREE.PlaneGeometry(planeSize,planeSize),material);this.mesh.position.z=Config.CAMERA_TARGET_DISTANCE}},{key:"setCamera",value:function setCamera(camera){this.camera=camera;this.camera.add(this.mesh);this.leave()}},{key:"storeUpdated",value:function storeUpdated(key,value){if(key==Proceeds.REQUEST_ANIMATION_FRAME)this.update();if(key==Proceeds.ADD_CLICKABLE)this.addClickable(value);if(key==Proceeds.REMOVE_CLICKABLE)this.removeClickable(value);if(key==Proceeds.VR_ACTIVE)this.vrStateChanged(value);if(key==Proceeds.GAME_SECTION_ACTIVE)this.gameStateChanged(value)}},{key:"addClickable",value:function addClickable(clickable){this.clickables.push(clickable);this.meshes=this.clickables.map(function(el,i){return el.mesh})}},{key:"removeClickable",value:function removeClickable(clickable){this.remove(this.clickables,clickable);this.meshes=this.clickables.map(function(el,i){return el.mesh})}},{key:"remove",value:function remove(array,element){var index=array.indexOf(element);if(index!==-1){array.splice(index,1)}}},{key:"vrStateChanged",value:function vrStateChanged(){this.toggleCursorVisibility()}},{key:"gameStateChanged",value:function gameStateChanged(){this.toggleCursorVisibility()}},{key:"toggleCursorVisibility",value:function toggleCursorVisibility(){var gameActive=_store.get(Proceeds.GAME_SECTION_ACTIVE);var vrActive=_store.get(Proceeds.VR_ACTIVE);if(vrActive==true||gameActive==true&&AFRAME.utils.device.isMobile()){this.show()}else{this.hide()}}},{key:"update",value:function update(){this.updateScale();this.drawCursor();this.setMouse();if(this.camera)this.raycastForHover()}},{key:"updateScale",value:function updateScale(){this.scale.update();this.mesh.scale.set(this.scale.value(),this.scale.value(),this.scale.value());this.scaleInner.update()}},{key:"setMouse",value:function setMouse(){switch(_store.get(Proceeds.CONTROL_MODE)){case Proceeds.CONTROL_MODE_DESKTOP:this.mouse.x=2*(-.5+window.proceeds.pointerPos.xPercent());this.mouse.y=-2*(-.5+window.proceeds.pointerPos.yPercent());break;default:this.mouse.x=this.mouse.y=0}}},{key:"raycastForHover",value:function raycastForHover(){if(this.clickables.length==0)return;this.raycaster.setFromCamera(this.mouse,this.camera);var intersects=this.raycaster.intersectObjects(this.meshes,false);if(intersects.length>0){var clickableFound=this.clickables.find(function(el,i,arr){return el.mesh===intersects[0].object});if(this.hoveredClickable!=clickableFound){if(this.hoveredClickable)this.hoveredClickable.leave();this.enter(clickableFound)}}else{this.leave()}}},{key:"drawCursor",value:function drawCursor(){this.radius=this.canvas.width*.4;this.context.clearRect(0,0,this.canvas.width,this.canvas.height);if(this.hoverTimeout!=null)this.drawPieAnimation();this.drawCursorCircles();this.canvasTexture.needsUpdate=true}},{key:"drawPieAnimation",value:function drawPieAnimation(){var startRads=-Math.PI/2;var progress=(Date.now()-this.hoverStartTime)/Config.HOVER_TIME;var center=this.canvas.width*.5;this.context.lineWidth=0;this.context.strokeStyle="rgba(255, 255, 255, 0)";this.context.fillStyle="#18BDE7";CanvasUtil.drawArc(this.context,center,center,this.radius*.98,startRads,startRads+progress*(Math.PI*2))}},{key:"drawCursorCircles",value:function drawCursorCircles(){var center=this.canvas.width*.5;this.context.lineWidth=10;this.context.strokeStyle="rgba(255, 255, 255, 1)";this.context.fillStyle="rgba(255, 255, 255, 0)";CanvasUtil.drawArc(this.context,center,center,this.radius,0,Math.PI*2,false);this.context.lineWidth=0;this.context.strokeStyle="rgba(255, 255, 255, 0)";this.context.fillStyle="rgba(255, 255, 255, 1)";CanvasUtil.drawArc(this.context,center,center,this.radius*this.scaleInner.value(),0,Math.PI*2)}},{key:"enter",value:function enter(clickable){this.hoveredClickable=clickable;if(this.hoveredClickable)this.hoveredClickable.hover();if(_store.get(Proceeds.CONTROL_MODE)==Proceeds.CONTROL_MODE_DESKTOP)document.body.classList.add("pointer-cursor");if(this.hoveredClickable.click){this.scale.setTarget(1.4);this.scaleInner.setTarget(this.innerScaleLarge);this.startClickTimer()}}},{key:"startClickTimer",value:function startClickTimer(){var _this2=this;if(_store.get(Proceeds.CONTROL_MODE)==Proceeds.CONTROL_MODE_DESKTOP)return;clearTimeout(this.hoverTimeout);this.hoverStartTime=Date.now();this.hoverTimeout=setTimeout(function(){if(_this2.hoveredClickable&&_this2.hoveredClickable.click)_this2.hoveredClickable.click()},Config.HOVER_TIME)}},{key:"leave",value:function leave(){if(this.hoveredClickable)this.hoveredClickable.leave();this.hoveredClickable=null;if(_store.get(Proceeds.CONTROL_MODE)==Proceeds.CONTROL_MODE_DESKTOP)document.body.classList.remove("pointer-cursor");this.scale.setTarget(1);this.scaleInner.setTarget(this.innerScaleSmall);this.cancelClickTimer()}},{key:"cancelClickTimer",value:function cancelClickTimer(){if(this.hoverTimeout!=null){clearTimeout(this.hoverTimeout);this.hoverTimeout=null}}},{key:"checkMouseClick",value:function checkMouseClick(e){if(_store.get(Proceeds.CONTROL_MODE)==Proceeds.CONTROL_MODE_DESKTOP){if(this.hoveredClickable){if(this.hoveredClickable&&this.hoveredClickable.click)this.hoveredClickable.click();this.leave()}}}},{key:"show",value:function show(){this.mesh.visible=true}},{key:"hide",value:function hide(){this.mesh.visible=false;this.hoverStartTime=0}}]);return Cursor}();"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Button3d=function(){function Button3d(path,callback,img,aspect,height){var showOnLoad=arguments.length>5&&arguments[5]!==undefined?arguments[5]:true;_classCallCheck(this,Button3d);this.scene=_store.get(Proceeds.THREE_SCENE);_store.addListener(this);this.path=path;this.isSelected=false;this.callback=callback;this.showOnLoad=showOnLoad;this.buildMesh(height*aspect,height);this.scaleHover=new ElasticFloat(1);this.scaleShow=new LinearFloat(0);if(img!=null)this.loadTextureImage(img);this.clickableObj=new Clickable(this,this.mesh,this.click.bind(this),this.hover.bind(this),this.leave.bind(this));_store.set(Proceeds.ADD_CLICKABLE,this.clickableObj);this.toggleActive(_store.get(Proceeds.CUR_PATH_UPDATED))}_createClass(Button3d,[{key:"loadTextureImage",value:function loadTextureImage(img){var _this=this;(new THREE.TextureLoader).load(img,function(texture){_this.mesh.material.map=texture;_this.mesh.material.needsUpdate=true;_this.mesh.visible=true;if(_this.showOnLoad)_this.scaleShow.setTarget(1)})}},{key:"storeUpdated",value:function storeUpdated(key,value){if(key==Proceeds.REQUEST_ANIMATION_FRAME)this.update();if(key==Proceeds.CUR_PATH_UPDATED)this.toggleActive(value)}},{key:"buildMesh",value:function buildMesh(width,height){var geometry=new THREE.PlaneGeometry(width,height);this.material=new THREE.MeshBasicMaterial({color:16777215,side:THREE.FrontSide,transparent:true});this.mesh=new THREE.Mesh(geometry,this.material);this.mesh.position.z=-Config.BUTTON_DISTANCE;this.mesh.position.y=Config.BASE_Y;this.mesh.visible=false;this.scene.add(this.mesh)}},{key:"toggleActive",value:function toggleActive(value){if(value==this.path){this.selected()}else{this.unselected()}}},{key:"update",value:function update(){this.scaleHover.update();this.scaleShow.update();if(this.mesh.visible==true&&this.scaleShow.value()==0)this.mesh.visible=false;var curScale=Math.max(1e-5,this.scaleHover.value()*this.scaleShow.valuePenner(Penner.easeInOutExpo));this.mesh.scale.set(curScale,curScale,curScale)}},{key:"setPosition",value:function setPosition(x,y,z){this.mesh.position.set(x,y,z);this.mesh.lookAt(Config.BASE_Y_CAMERA)}},{key:"click",value:function click(){if(this.path!=null){_store.set(Proceeds.NAVIGATION_PATH,this.path);_store.set(Proceeds.AUTOPLAY_ALL_VIDEOS,false)}else{this.callback()}this.leave()}},{key:"hover",value:function hover(){if(this.isSelected==true)return;this.scaleHover.setTarget(1.2)}},{key:"leave",value:function leave(){if(this.isSelected==true)return;this.scaleHover.setTarget(1)}},{key:"show",value:function show(){this.scaleShow.setTarget(1);if(this.isSelected==true)this.scaleShow.setTarget(.7);this.mesh.visible=true}},{key:"hide",value:function hide(){this.scaleShow.setTarget(0)}},{key:"selected",value:function selected(){this.isSelected=true;this.material.color.set(10066329);this.scaleHover.setTarget(.9);this.clickableObj.click=null}},{key:"unselected",value:function unselected(){this.isSelected=false;this.material.color.set(16777215);this.scaleHover.setTarget(1);this.clickableObj.click=this.click.bind(this)}}]);return Button3d}();"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
var Menu3d=function(){
	function Menu3d(){
		_classCallCheck(this,Menu3d);
		_store.addListener(this);
		this.showing=false;
		this.buttons=[];
		this.links=[
			{path:"climbing",img:"/giving-back/assets/images/vr/3d/buttons/vr-card-climbing.png"},
			{path:"biking",img:"/giving-back/assets/images/vr/3d/buttons/vr-card-biking.png"},
			{path:"skiing",img:"/giving-back/assets/images/vr/3d/buttons/vr-card-skiing.png"},
			{path:"mustang",img:"/giving-back/assets/images/vr/3d/buttons/vr-card-mustang.png"},
			{path:"ouray",img:"/giving-back/assets/images/vr/3d/buttons/vr-card-ouray.png"},
			{path:"game",img:"/giving-back/assets/images/vr/3d/buttons/vr-card-game.png"}
		]
	}
	_createClass(Menu3d,[{key:"lazyBuildButtons",value:function lazyBuildButtons(){if(this.buttons.length>0)return;var numButtons=this.links.length;this.circleDistroRads=Math.PI*2/12;this.offsetRadians=Config.BUTTONS_ROT_OFFSET-this.circleDistroRads*numButtons/2+this.circleDistroRads/2;var aspect=344/422;var height=2;for(var i=0;i<numButtons;i++){var button=new Button3d(this.links[i].path,null,this.links[i].img,aspect,height,false);var buttonRadians=this.offsetRadians+this.circleDistroRads*i;button.setPosition(Config.BUTTON_DISTANCE*Math.cos(buttonRadians),Config.BASE_Y,Config.BUTTON_DISTANCE*Math.sin(buttonRadians));button.hide();this.buttons.push(button)}}},{key:"buildMenuToggle",value:function buildMenuToggle(){if(this.menuShowButton)return;this.menuShowButton=new Button3d(null,this.menuShowButtonClick.bind(this),Config.MENU_OPEN_ICON,1,4);this.menuShowButton.setPosition(Config.BUTTON_TOGGLE_DISTANCE*Math.cos(Config.BUTTONS_ROT_OFFSET),Config.MENU_TOGGLE_Y,Config.BUTTON_TOGGLE_DISTANCE*Math.sin(Config.BUTTONS_ROT_OFFSET));this.menuHideButton=new Button3d(null,this.menuHideButtonClick.bind(this),Config.MENU_COSE_ICON,1,4,false);this.menuHideButton.setPosition(Config.BUTTON_TOGGLE_DISTANCE*Math.cos(Config.BUTTONS_ROT_OFFSET),Config.MENU_TOGGLE_Y,Config.BUTTON_TOGGLE_DISTANCE*Math.sin(Config.BUTTONS_ROT_OFFSET))}},{key:"menuShowButtonClick",value:function menuShowButtonClick(){this.show()}},{key:"menuHideButtonClick",value:function menuHideButtonClick(){this.hide()}},{key:"storeUpdated",value:function storeUpdated(key,value){if(key==Proceeds.REQUEST_ANIMATION_FRAME)this.update();if(key==Proceeds.VR_ACTIVE)this.toggleMenu(value);if(key==Proceeds.GAME_ACTIVE&&value==true)this.hide();if(key==Proceeds.GAME_ACTIVE&&value==true)this.hideToggle();if(key==Proceeds.GAME_ACTIVE&&value==false)this.showToggle();if(_store.get(Proceeds.VR_ACTIVE)==true){if(key==Proceeds.NAVIGATION_PATH)this.hide();if(key==Proceeds.SHOW_3D_MENU)this.show()}}},{key:"toggleMenu",value:function toggleMenu(vrActive){if(vrActive==true){this.lazyBuildButtons();this.buildMenuToggle();this.showToggle()}else{this.hide();this.hideToggle()}}},{key:"show",value:function show(){var _this=this;this.buttons.forEach(function(el,i){setTimeout(function(){return el.show()},i*100)});this.menuShowButton.hide();setTimeout(function(){return _this.menuHideButton.show()},1e3);_store.set(Proceeds.MENU_3D_SHOWING,true)}},{key:"hide",value:function hide(){var _this2=this;if(this.menuHideButton==null)return;this.buttons.forEach(function(el,i){el.hide()});this.menuHideButton.hide();if(_store.get(Proceeds.VR_ACTIVE)==true&&_store.get(Proceeds.GAME_ACTIVE)!=true){setTimeout(function(){return _this2.menuShowButton.show()},1e3)}_store.set(Proceeds.MENU_3D_SHOWING,false)}},{key:"showToggle",value:function showToggle(){if(this.menuHideButton==null)return;this.menuHideButton.hide();this.menuShowButton.show()}},{key:"hideToggle",value:function hideToggle(){if(this.menuHideButton==null)return;this.menuHideButton.hide();this.menuShowButton.hide()}},{key:"update",value:function update(){}}]);return Menu3d}();"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Loader=function(){function Loader(){_classCallCheck(this,Loader);this.scene=_store.get(Proceeds.THREE_SCENE);_store.addListener(this);this.buildFog();this.loadingTexture=new LoadingCanvasAnim;this.buildLoadingIcon()}_createClass(Loader,[{key:"storeUpdated",value:function storeUpdated(key,value){if(key==Proceeds.REQUEST_ANIMATION_FRAME)this.update();if(key==Proceeds.LOADING_360_TEXTURE){if(value==true)this.startMediaTransition()}if(key==Proceeds.VIDEO_BUFFERING&&value==true)this.show();if(key==Proceeds.VIDEO_BUFFERING&&value==false)this.hide()}},{key:"buildFog",value:function buildFog(){this.fogEaser=new LinearFloat(0,.02);this.fogNear=-10;this.fogFar=20;this.scene.fog=new THREE.Fog(0,0,.02)}},{key:"setFog",value:function setFog(){this.scene.fog.near=this.fogEaser.valueMapped(this.fogNear,this.fogFar);this.scene.fog.far=this.fogEaser.valueMapped(this.fogNear,this.fogFar)+20}},{key:"updateFog",value:function updateFog(){this.fogEaser.update();this.setFog()}},{key:"update",value:function update(){this.updateFog();if(this.scaleShow.value()>0)this.loadingTexture.update();this.updateMesh();this.checkLoadingFinished();this.checkBuffering()}},{key:"startMediaTransition",value:function startMediaTransition(){this.fogEaser.setTarget(0);this.fogEaser.update();this.show();document.body.classList.add("media-loading")}},{key:"stopLoading",value:function stopLoading(){}},{key:"checkLoadingFinished",value:function checkLoadingFinished(){if(_store.get(Proceeds.LOADING_360_TEXTURE)==false&&this.fogEaser.value()==0){_store.set(Proceeds.LOADER_HIDDEN,true);this.fogEaser.setTarget(1);this.fogEaser.update();document.body.classList.remove("media-loading")}}},{key:"checkBuffering",value:function checkBuffering(){if(_store.get(Proceeds.LOADING_360_TEXTURE)==false&&_store.get(Proceeds.VIDEO_BUFFERING)==false&&this.scaleShow.value()==1){this.hide()}}},{key:"buildLoadingIcon",value:function buildLoadingIcon(){this.scaleShow=new LinearFloat(0,.05);var size=1;this.buildMesh(size,size);this.setCamera(_store.get(Proceeds.THREE_CAMERA));if(_store.get(Proceeds.LOADING_360_TEXTURE)==true)this.show()}},{key:"buildMesh",value:function buildMesh(width,height){this.mesh=new THREE.Mesh(new THREE.PlaneGeometry(width,height),this.loadingTexture.material);this.mesh.visible=false;this.mesh.position.z=Config.CAMERA_TARGET_DISTANCE*.98}},{key:"setCamera",value:function setCamera(camera){this.camera=camera;this.camera.add(this.mesh)}},{key:"updateMesh",value:function updateMesh(){this.scaleShow.update();if(this.mesh.visible==true&&this.scaleShow.value()==0)this.mesh.visible=false;if(this.mesh.visible){this.mesh.material.opacity=this.scaleShow.value();var curScale=.5+.5*this.scaleShow.valuePenner(Penner.easeInOutQuad)}}},{key:"show",value:function show(){this.scaleShow.setTarget(1);this.mesh.visible=true}},{key:"hide",value:function hide(){this.scaleShow.setTarget(0)}}]);return Loader}();var LoadingCanvasAnim=function(){function LoadingCanvasAnim(){_classCallCheck(this,LoadingCanvasAnim);this.buildCanvas();this.buildCanvasTexture();this.numParticles=18;this.endRadius=150;this.colors=[CanvasUtil.hex2rgb("DBA81B"),CanvasUtil.hex2rgb("E98024"),CanvasUtil.hex2rgb("01A5DC"),CanvasUtil.hex2rgb("8BB331"),CanvasUtil.hex2rgb("563281")];this.colorIndex=0;this.bubble=new Bubble(this.context,this);this.buildParticles()}_createClass(LoadingCanvasAnim,[{key:"buildCanvas",value:function buildCanvas(){this.canvas=document.createElement("canvas");this.canvas.width=512;this.canvas.height=512;this.context=this.canvas.getContext("2d")}},{key:"buildCanvasTexture",value:function buildCanvasTexture(){this.canvasTexture=new THREE.Texture(this.canvas);this.material=new THREE.MeshBasicMaterial({color:16777215,map:this.canvasTexture,side:THREE.FrontSide,transparent:true,opacity:1,alphaTest:.1,fog:false})}},{key:"curColor",value:function curColor(){return this.colors[this.colorIndex]}},{key:"nextColor",value:function nextColor(){this.colorIndex++;if(this.colorIndex>=this.colors.length)this.colorIndex=0}},{key:"buildParticles",value:function buildParticles(){this.particles=[];for(var i=0;i<this.numParticles;i++){this.particles.push(new Particle(this.context,this))}}},{key:"burst",value:function burst(){var rads=Math.PI*2/this.particles.length;for(var i=0;i<this.particles.length;i++){this.particles[i].launch(this.endRadius*.9,rads*i)}}},{key:"update",value:function update(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height);this.bubble.update();this.particles.forEach(function(el,i){if(el.active())el.update()});this.canvasTexture.needsUpdate=true}}]);return LoadingCanvasAnim}();var Bubble=function(){function Bubble(context,textureObj){_classCallCheck(this,Bubble);this.context=context;this.textureObj=textureObj;this.center=this.context.canvas.width*.5;this.radiusStart=10;this.radiusEnd=this.textureObj.endRadius/2;this.reset()}_createClass(Bubble,[{key:"lerp",value:function lerp(val1,val2,percent){return val1+(val2-val1)*percent}},{key:"reset",value:function reset(){this.radius=this.radiusStart;this.alpha=0;this.strokeWMult=2;this.burst=false;this.textureObj.nextColor()}},{key:"curColor",value:function curColor(){return"rgba("+this.textureObj.curColor().r+", "+this.textureObj.curColor().g+", "+this.textureObj.curColor().b+", "+this.alpha+")"}},{key:"update",value:function update(){var progress=this.radius/this.radiusEnd;if(progress>.98){if(this.burst==false){this.burst=true;this.textureObj.burst()}this.strokeWMult=this.lerp(this.strokeWMult,0,.35)}if(this.strokeWMult==2){this.radius=this.lerp(this.radius,this.radiusEnd,.05);this.alpha=this.lerp(this.alpha,1,.07)}else{this.radius=this.lerp(this.radius,this.radiusEnd*1.9,.3);this.alpha=this.lerp(this.alpha,0,.1)}if(this.strokeWMult<.001){this.reset()}this.context.fillStyle="rgba(0,0,0,0)";this.context.lineWidth=this.radius*this.strokeWMult;this.context.strokeStyle=this.curColor();CanvasUtil.drawArc(this.context,this.center,this.center,this.radius,0,Math.PI*2,false)}}]);return Bubble}();var Particle=function(){function Particle(context,textureObj){_classCallCheck(this,Particle);this.context=context;this.textureObj=textureObj;this.center=this.context.canvas.width*.5;this.size=0}_createClass(Particle,[{key:"launch",value:function launch(radius,rads){this.x=this.center+Math.cos(rads)*radius;this.y=this.center+Math.sin(rads)*radius;this.size=6;this.speed=3;this.rads=rads+=.4+Math.random()*.8;this.alpha=1}},{key:"active",value:function active(){return this.size>.3}},{key:"curColor",value:function curColor(){return"rgba("+this.textureObj.curColor().r+", "+this.textureObj.curColor().g+", "+this.textureObj.curColor().b+", "+this.alpha+")"}},{key:"update",value:function update(){this.size-=.2;this.alpha-=.02;this.x+=Math.cos(this.rads)*this.speed;this.y+=Math.sin(this.rads)*this.speed;this.speed*=.97;this.context.strokeStyle="rgba(0,0,0,0)";this.context.fillStyle=this.curColor();CanvasUtil.drawArc(this.context,this.x,this.y,this.size,0,Math.PI*2,false)}}]);return Particle}();"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var AudioToggle=function(){function AudioToggle(){_classCallCheck(this,AudioToggle);this.scene=_store.get(Proceeds.THREE_SCENE);_store.addListener(this);this.unmutedOnce=false;this.initButton();this.initMutedState();if(AFRAME.utils.device.isMobile()==true||AFRAME.utils.device.isMobile()==false)this.initMobileInitialUnmute()}_createClass(AudioToggle,[{key:"initButton",value:function initButton(){var _this=this;this.button=document.getElementById("audio-toggle");this.button.addEventListener("click",function(e){return _this.click(e)})}},{key:"initMutedState",value:function initMutedState(){this.muted=true;_store.set(Proceeds.AUDIO_MUTED,this.muted);this.updateBodyClass()}},{key:"click",value:function click(e){this.muted=!this.muted;this.updateBodyClass();_store.set(Proceeds.AUDIO_MUTED,this.muted)}},{key:"initMobileInitialUnmute",value:function initMobileInitialUnmute(){this.bodyListener=this.bodyClick.bind(this);document.body.addEventListener("click",this.bodyListener)}},{key:"bodyClick",value:function bodyClick(e){if(DOMUtil.closest(e.target,"a.audio-unmute"))this.click();if(DOMUtil.closest(e.target,"div.audio-unmute"))this.click()}},{key:"updateBodyClass",value:function updateBodyClass(){if(this.muted)document.body.classList.add("muted");else document.body.classList.remove("muted");if(this.muted==false&&this.unmutedOnce==false){this.unmutedOnce=true;if(this.bodyListener)document.body.removeEventListener("click",this.bodyListener)}}},{key:"storeUpdated",value:function storeUpdated(key,value){}}]);return AudioToggle}();"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var ObjectPool=function(){function ObjectPool(klass){_classCallCheck(this,ObjectPool);this.klass=klass;this.objects=[]}_createClass(ObjectPool,[{key:"pool",value:function pool(){return this.objects}},{key:"getObject",value:function getObject(){var freeObject=this.objects.find(function(el){return el.active==false});if(freeObject){return freeObject}else{this.objects.push(new this.klass);return this.objects[this.objects.length-1]}}},{key:"anyActive",value:function anyActive(){return null!=this.objects.find(function(el){return el.active==true})}}]);return ObjectPool}();"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var GameInstructions=function(){function GameInstructions(){_classCallCheck(this,GameInstructions);this.scene=_store.get(Proceeds.THREE_SCENE);_store.addListener(this);this.scaleShow=new LinearFloat(0,.04);var aspect=4/1;this.buildMesh(Config.GAME_INSTRUCTIONS_HEIGHT*aspect,Config.GAME_INSTRUCTIONS_HEIGHT);this.loadTextureImage(Config.INSTRUCTIONS_BANNER_IMG)}_createClass(GameInstructions,[{key:"loadTextureImage",value:function loadTextureImage(img){var _this=this;(new THREE.TextureLoader).load(img,function(texture){_this.mesh.material.map=texture;_this.mesh.material.needsUpdate=true})}},{key:"storeUpdated",value:function storeUpdated(key,value){if(key==Proceeds.CONTROL_MODE)this.updateControlMode();if(key==Proceeds.REQUEST_ANIMATION_FRAME)this.update();if(key==Proceeds.GAME_INSTRUCTIONS_SHOWING&&value==false)this.hide();if(key==Proceeds.GAME_INSTRUCTIONS_SHOWING&&value==true)this.show();if(key==Proceeds.GAME_SECTION_ACTIVE&&value==false)this.hide()}},{key:"updateControlMode",value:function updateControlMode(){this.rotationY=_store.get(Proceeds.CONTROL_MODE)==Proceeds.CONTROL_MODE_DESKTOP?0:Config.BUTTONS_ROT_OFFSET;this.setPosition(Config.INSTRUCTIONS_PLANE_DISTANCE*Math.cos(this.rotationY),Config.INSTRUCTIONS_Y,Config.INSTRUCTIONS_PLANE_DISTANCE*Math.sin(this.rotationY))}},{key:"setPosition",value:function setPosition(x,y,z){this.mesh.position.set(x,y,z);this.mesh.lookAt(Config.BASE_Y_CAMERA)}},{key:"buildMesh",value:function buildMesh(width,height){var geometry=new THREE.PlaneGeometry(width,height);this.material=new THREE.MeshBasicMaterial({color:16777215,side:THREE.FrontSide,transparent:true,alphaTest:.5});this.mesh=new THREE.Mesh(geometry,this.material);this.mesh.visible=false;this.scene.add(this.mesh);this.updateControlMode()}},{key:"update",value:function update(){this.scaleShow.update();this.mesh.material.needsUpdate=true;if(this.mesh.visible==true&&this.scaleShow.value()==0)this.mesh.visible=false;var curScale=Math.max(1e-5,this.scaleShow.valuePenner(Penner.easeInOutQuad));this.mesh.scale.set(curScale,curScale,curScale)}},{key:"show",value:function show(){var _this2=this;this.showTimeout=setTimeout(function(){_this2.scaleShow.setTarget(1);_this2.mesh.visible=true},500)}},{key:"hide",value:function hide(){clearTimeout(this.showTimeout);this.scaleShow.setTarget(0)}}]);return GameInstructions}();"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var GameScoreboard=function(){function GameScoreboard(){_classCallCheck(this,GameScoreboard);this.scene=_store.get(Proceeds.THREE_SCENE);_store.addListener(this);this.scaleShow=new LinearFloat(0,.04);var aspect=1;var height=8;this.buildCanvas();this.buildCanvasTexture();this.buildMesh(height*aspect,height);this.loadTextureImage(Config.GAME_SCORE_BG_IMG);this.scoreEaser=new EaseToValueCallback(0,10,this.scoreEaseUpdate.bind(this));this.easedScore=0;if(_store.get(Proceeds.GAME_ACTIVE)==true)this.show()}_createClass(GameScoreboard,[{key:"loadTextureImage",value:function loadTextureImage(img){var _this=this;this.img=new Image;this.img.onload=function(){_this.drawBgImage()};this.img.src=img}},{key:"drawBgImage",value:function drawBgImage(){this.context.drawImage(this.img,0,0,this.canvas.width,this.canvas.height)}},{key:"drawScore",value:function drawScore(){this.context.font="60px FSEmeric-Bold";this.context.fillStyle="#008EB3";this.context.textAlign="center";this.context.fillText(this.addCommasToNumber(Math.round(this.easedScore*1e6)),256,277)}},{key:"addCommasToNumber",value:function addCommasToNumber(str){var x=(str+"").split(".");var x1=x[0];var x2=x.length>1?"."+x[1]:"";var rgx=/(\d+)(\d{3})/;while(rgx.test(x1)){x1=x1.replace(rgx,"$1"+","+"$2")}return x1+x2}},{key:"drawTimer",value:function drawTimer(){this.context.font="80px FSEmeric-Bold";this.context.fillStyle="white";this.context.textAlign="center";var timeStr=_store.get(Proceeds.GAME_TIMER);if(_store.get(Proceeds.GAME_TIMER)<10)timeStr="0"+timeStr;timeStr="00:"+timeStr;this.context.fillText(timeStr,256,378)}},{key:"updateTexture",value:function updateTexture(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height);this.drawBgImage();this.drawScore();this.drawTimer();this.canvasTexture.needsUpdate=true}},{key:"buildCanvas",value:function buildCanvas(){this.canvas=document.createElement("canvas");this.canvas.width=512;this.canvas.height=512;this.context=this.canvas.getContext("2d")}},{key:"buildCanvasTexture",value:function buildCanvasTexture(){this.canvasTexture=new THREE.Texture(this.canvas);this.material=new THREE.MeshBasicMaterial({map:this.canvasTexture,side:THREE.FrontSide,transparent:true,alphaTest:.5})}},{key:"buildMesh",value:function buildMesh(width,height){this.mesh=new THREE.Mesh(new THREE.PlaneGeometry(width,height),this.material);this.mesh.visible=false;this.scene.add(this.mesh);this.updateControlMode()}},{key:"storeUpdated",value:function storeUpdated(key,value){if(key==Proceeds.REQUEST_ANIMATION_FRAME)this.update();if(key==Proceeds.CONTROL_MODE)this.updateControlMode();if(key==Proceeds.GAME_POINTS)this.scoreUpdated(value);if(key==Proceeds.GAME_TIMER)this.timerUpdated(value);if(key==Proceeds.GAME_ACTIVE&&value==true)this.show();if(key==Proceeds.GAME_SECTION_ACTIVE&&value==false)this.hide();if(key==Proceeds.SHOW_3D_MENU)this.hide();if(key==Proceeds.MENU_3D_SHOWING)this.toggleOn3dMenu(value)}},{key:"scoreUpdated",value:function scoreUpdated(score){this.scoreEaser.setTarget(score)}},{key:"scoreEaseUpdate",value:function scoreEaseUpdate(value){this.easedScore=value;this.updateTexture()}},{key:"timerUpdated",value:function timerUpdated(timer){this.updateTexture()}},{key:"updateControlMode",value:function updateControlMode(){this.rotationY=_store.get(Proceeds.CONTROL_MODE)==Proceeds.CONTROL_MODE_DESKTOP?0:Config.BUTTONS_ROT_OFFSET;this.setPosition(Config.GAME_SCORE_DISTANCE*Math.cos(this.rotationY),Config.BASE_Y,Config.GAME_SCORE_DISTANCE*Math.sin(this.rotationY))}},{key:"setPosition",value:function setPosition(x,y,z){this.mesh.position.set(x,y,z);this.mesh.lookAt(Config.BASE_Y_CAMERA)}},{key:"update",value:function update(){this.scaleShow.update();if(this.mesh.visible==true&&this.scaleShow.value()==0)this.mesh.visible=false;var curScale=Math.max(1e-5,this.scaleShow.valuePenner(Penner.easeInOutQuad));this.mesh.scale.set(curScale,curScale,curScale)}},{key:"show",value:function show(){this.scaleShow.setTarget(1);this.mesh.visible=true}},{key:"hide",value:function hide(){this.scaleShow.setTarget(0)}},{key:"toggleOn3dMenu",value:function toggleOn3dMenu(isMenu3dShowing){if(_store.get(Proceeds.GAME_SECTION_ACTIVE)==true){if(isMenu3dShowing){this.hide()}else{if(_store.get(Proceeds.GAME_INSTRUCTIONS_SHOWING)==false){this.show()}}}}}]);return GameScoreboard}();"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var GameMenu=function(){function GameMenu(){_classCallCheck(this,GameMenu);this.scene=_store.get(Proceeds.THREE_SCENE);_store.addListener(this);this.buildButtons()}_createClass(GameMenu,[{key:"storeUpdated",value:function storeUpdated(key,value){if(key==Proceeds.CONTROL_MODE)this.updateControlMode();if(key==Proceeds.GAME_INSTRUCTIONS_SHOWING&&value==true)this.gameSectionStarted();if(key==Proceeds.GAME_SECTION_ACTIVE&&value==false)this.hide();if(key==Proceeds.GAME_ACTIVE&&value==false)this.gameOver()}},{key:"updateControlMode",value:function updateControlMode(){this.rotationY=_store.get(Proceeds.CONTROL_MODE)==Proceeds.CONTROL_MODE_DESKTOP?0:Config.BUTTONS_ROT_OFFSET;this.setButtonPosition(this.gameStartButton);this.setButtonPosition(this.replayButton)}},{key:"setButtonPosition",value:function setButtonPosition(button3d){button3d.setPosition(Config.BUTTON_TOGGLE_DISTANCE*Math.cos(this.rotationY),Config.GAME_START_BUTTON_Y,Config.BUTTON_TOGGLE_DISTANCE*Math.sin(this.rotationY))}},{key:"buildButtons",value:function buildButtons(){if(this.gameStartButton)return;this.gameStartButton=new Button3d(null,this.gameStartButtonClick.bind(this),Config.GAME_START_BUTTON_IMAGE,5/1,Config.GAME_START_BUTTON_SIZE,false);this.replayButton=new Button3d(null,this.replayButtonClick.bind(this),Config.GAME_REPLAY_BUTTON_IMAGE,5/1,Config.GAME_START_BUTTON_SIZE,false);this.updateControlMode()}},{key:"gameStartButtonClick",value:function gameStartButtonClick(){_store.set(Proceeds.GAME_ACTIVE,true);this.gameStartButton.hide()}},{key:"replayButtonClick",value:function replayButtonClick(){_store.set(Proceeds.GAME_ACTIVE,true);this.replayButton.hide()}},{key:"gameSectionStarted",value:function gameSectionStarted(){var _this=this;this.replayButton.hide();this.showStartButtonTimeout=setTimeout(function(){return _this.gameStartButton.show()},1e3)}},{key:"gameOver",value:function gameOver(){if(_store.get(Proceeds.GAME_SECTION_ACTIVE)==false)return;this.replayButton.show()}},{key:"hide",value:function hide(){clearTimeout(this.showStartButtonTimeout);this.replayButton.hide();this.gameStartButton.hide()}},{key:"update",value:function update(){}}]);return GameMenu}();"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var GameMultiplier=function(){function GameMultiplier(){_classCallCheck(this,GameMultiplier);this.scene=_store.get(Proceeds.THREE_SCENE);_store.addListener(this);this.scaleShow=new LinearFloat(0,.02);this.alphaEase=new LinearFloat(1,.01);var aspect=1;var height=1;this.buildCanvas();this.buildCanvasTexture();this.buildMesh(height*aspect,height);this.multiplier=0}_createClass(GameMultiplier,[{key:"drawMultiplier",value:function drawMultiplier(){var center=this.canvas.width*.5;var fontsize=120;this.context.font=fontsize+"px FSEmeric-Bold";this.context.fillStyle="#ffffff";this.context.textAlign="center";this.context.textBaseline="bottom";this.context.fillText(_store.get(Proceeds.GAME_STREAK)+1+"x",center,center+fontsize*.55)}},{key:"updateTexture",value:function updateTexture(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height);this.drawMultiplier();this.canvasTexture.needsUpdate=true}},{key:"buildCanvas",value:function buildCanvas(){this.canvas=document.createElement("canvas");this.canvas.width=256;this.canvas.height=256;this.context=this.canvas.getContext("2d")}},{key:"buildCanvasTexture",value:function buildCanvasTexture(){this.canvasTexture=new THREE.Texture(this.canvas);this.material=new THREE.MeshBasicMaterial({map:this.canvasTexture,side:THREE.FrontSide,transparent:true,alphaTest:.01})}},{key:"buildMesh",value:function buildMesh(width,height){this.mesh=new THREE.Mesh(new THREE.PlaneGeometry(width,height),this.material);this.mesh.visible=false;this.scene.add(this.mesh)}},{key:"storeUpdated",value:function storeUpdated(key,value){if(key==Proceeds.REQUEST_ANIMATION_FRAME)this.update();if(key==Proceeds.GAME_STREAK)this.multiplierUpdated(value);if(key==Proceeds.GAME_SECTION_ACTIVE&&value==false)this.hide()}},{key:"multiplierUpdated",value:function multiplierUpdated(value){this.streakRads=_store.get(Proceeds.POINT_RADS);this.multiplier=value;if(this.multiplier>0){this.updateTexture();this.show()}}},{key:"setPosition",value:function setPosition(x,y,z){this.mesh.position.set(x,y,z);this.mesh.lookAt(Config.BASE_Y_CAMERA)}},{key:"update",value:function update(){this.scaleShow.update();var curScale=7*Math.max(1e-5,this.scaleShow.valuePenner(Penner.easeOutQuad));this.mesh.scale.set(curScale,curScale,curScale);this.rotationY=_store.get(Proceeds.CONTROL_MODE)==Proceeds.CONTROL_MODE_DESKTOP?0:Config.BUTTONS_ROT_OFFSET;this.setPosition(Config.GAME_MULTIPLIER_DISTANCE*Math.cos(this.streakRads),Config.MULTIPLIER_Y-2*(1-this.scaleShow.valuePenner(Penner.easeOutQuad)),Config.GAME_MULTIPLIER_DISTANCE*Math.sin(this.streakRads));this.alphaEase.update();this.material.opacity=this.alphaEase.valuePenner(Penner.easeInQuad)}},{key:"show",value:function show(){this.scaleShow.setValue(0);this.scaleShow.setTarget(1);this.alphaEase.setValue(1);this.alphaEase.setTarget(0);this.mesh.visible=true}},{key:"hide",value:function hide(){}}]);return GameMultiplier}();"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var GameParticles=function(){function GameParticles(){_classCallCheck(this,GameParticles);_store.addListener(this);this.particlePool=new ObjectPool(GameParticle)}_createClass(GameParticles,[{key:"storeUpdated",value:function storeUpdated(key,value){if(key==Proceeds.POINT_POSITION)this.launchParticles()}},{key:"launchParticles",value:function launchParticles(){var position=_store.get(Proceeds.POINT_POSITION);var hexColor=_store.get(Proceeds.POINT_COLOR);for(var i=0;i<25;i++){var particle=this.particlePool.getObject();particle.launch(position,hexColor)}}}]);return GameParticles}();var GameParticle=function(){function GameParticle(){_classCallCheck(this,GameParticle);this.active=false;this.scene=_store.get(Proceeds.THREE_SCENE);_store.addListener(this);this.scaleShow=new LinearFloat(0,.02);this.alphaEase=new LinearFloat(1,.01);this.speed=new THREE.Vector3;this.float=new THREE.Vector3(0,-.001,0);var size=.09;this.buildMesh(size,size)}_createClass(GameParticle,[{key:"buildMesh",value:function buildMesh(width,height){this.material=new THREE.MeshBasicMaterial({side:THREE.FrontSide,color:16777215});this.mesh=new THREE.Mesh(new THREE.PlaneGeometry(width,height),this.material)}},{key:"storeUpdated",value:function storeUpdated(key,value){if(key==Proceeds.REQUEST_ANIMATION_FRAME)this.update()}},{key:"setPosition",value:function setPosition(x,y,z){this.mesh.position.set(x,y,z)}},{key:"update",value:function update(){this.updateScale();this.updatePosition();this.alphaEase.update();if(this.active==true&&this.scaleShow.value()==0){this.scene.remove(this.mesh);this.active=false}}},{key:"updateScale",value:function updateScale(){this.scaleShow.update();var curScale=Math.max(1e-5,this.scaleShow.valuePenner(Penner.easeOutQuad));this.mesh.scale.set(curScale,curScale,curScale)}},{key:"updatePosition",value:function updatePosition(){this.speed.add(this.float);this.speed.set(this.speed.x*.98,this.speed.y*.98,this.speed.z*.98);this.mesh.position.add(this.speed);this.mesh.rotation.set(this.mesh.rotation.x+this.speed.x*3,this.mesh.rotation.y+this.speed.y*3,this.mesh.rotation.z+this.speed.z*3)}},{key:"launch",value:function launch(position,hexColor){this.scaleShow.setValue(1);this.scaleShow.setTarget(0);this.alphaEase.setValue(1);this.alphaEase.setTarget(0);this.updateScale();this.active=true;this.scene.add(this.mesh);this.mesh.position.set(position.x+this.randomOffset(),position.y+this.randomOffset(),position.z+this.randomOffset());this.speed.set(this.randomSpeed(),this.randomSpeed(),this.randomSpeed());this.mesh.lookAt(Config.BASE_Y_CAMERA);this.mesh.material.color.setHex(this.hexStringToNumberColor(hexColor));if(Math.random()>.7)this.mesh.material.color.multiplyScalar(1+4*Math.random());this.mesh.rotation.set(Math.PI*2*Math.random(),Math.PI*2*Math.random(),Math.PI*2*Math.random())}},{key:"randomOffset",value:function randomOffset(){return-.3+.6*Math.random()}},{key:"randomSpeed",value:function randomSpeed(){return-.06+.12*Math.random()}},{key:"hexStringToNumberColor",value:function hexStringToNumberColor(hexStr){return Number("0x"+hexStr.replace("#",""))}}]);return GameParticle}();"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var SoundPlayer=function(){function SoundPlayer(soundsHash,clickSoundID){_classCallCheck(this,SoundPlayer);_store.addListener(this);this.clickSoundID=clickSoundID;this.loadSounds(soundsHash);if(_store.get(Proceeds.AUDIO_MUTED))this.toggleMute()}_createClass(SoundPlayer,[{key:"loadSounds",value:function loadSounds(soundsHash){var _this=this;this.sounds={};var soundIDs=Object.keys(soundsHash);soundIDs.forEach(function(el,i,arr){var fileName=soundsHash[el];_this.sounds[fileName]=new Howl({src:[fileName]})})}},{key:"toggleMute",value:function toggleMute(){var muted=_store.get(Proceeds.AUDIO_MUTED);Howler.mute(muted);if(muted==false)this.playSound(this.clickSoundID)}},{key:"getSound",value:function getSound(soundId){return this.sounds[soundId]}},{key:"storeUpdated",value:function storeUpdated(key,value){if(key==Proceeds.AUDIO_MUTED)this.toggleMute();if(key==Proceeds.PLAY_SOUND){if((typeof value==="undefined"?"undefined":_typeof(value)).toLowerCase()==="string"){this.playSound(value)}else{var soundIDs=value;var index=Math.min(Math.floor(Math.random()*(soundIDs.length-1)),soundIDs.length-1);this.playSound(soundIDs[index])}}}},{key:"playSound",value:function playSound(soundId){if(this.sounds[soundId])this.sounds[soundId].play()}}]);return SoundPlayer}();"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var AreaHome=function(){function AreaHome(el){_classCallCheck(this,AreaHome);this.el=el;this.el.scrollTop=0;_store.addListener(this);this.addScrollHandler();this.buildDesktopNavCardMouseTilt();if(_store.get(Proceeds.CURRENT_360_MEDIA)!=Config.media["home"]){_store.set(Proceeds.CURRENT_360_IMAGE,Config.media["home"]);_store.set(Proceeds.CURRENT_360_MEDIA,Config.media["home"])}}_createClass(AreaHome,[{key:"buildDesktopNavCardMouseTilt",value:function buildDesktopNavCardMouseTilt(){if(AFRAME.utils.device.isMobile()==false){this.buttons=this.el.querySelectorAll(".sections-nav a");this.easedMouseX=[];for(var i=0;i<this.buttons.length;i++){this.easedMouseX.push(new EasingFloat(0,14))}}this.mtnDivider=this.el.querySelector(".mtn-divider");this.mtnOffset=new EasingFloat(0,14)}},{key:"storeUpdated",value:function storeUpdated(key,value){if(key==Proceeds.REQUEST_ANIMATION_FRAME&&this.buttons)this.update()}},{key:"update",value:function update(){var _this=this;this.buttons.forEach(function(el,i){var perspective=600;var tiltY=-.5+window.proceeds.pointerPos.yPercent(el);tiltY*=-17;var tiltX=-.5+window.proceeds.pointerPos.xPercent(el);tiltX*=5;var scale=_this.clamp(1.1-.02*Math.abs(tiltX),.95,1.15);_this.easedMouseX[i].setTarget(scale);_this.easedMouseX[i].update();scale=_this.easedMouseX[i].value();el.style.transform="perspective("+perspective+"px) "+"rotateX("+_this.clamp(tiltY,-15,15)+"deg) "+"rotateY("+_this.clamp(tiltX,-15,15)+"deg) "+"scale3d("+scale+", "+scale+", "+scale+")"});var lastOffsetX=this.mtnOffset.value();this.mtnOffset.update();if(lastOffsetX!=this.mtnOffset.value()){this.mtnDivider.style.backgroundPosition=this.mtnOffset.value()*-.2+"px bottom"}}},{key:"clamp",value:function clamp(val,min,max){return Math.max(min,Math.min(max,val))}},{key:"addScrollHandler",value:function addScrollHandler(){this.scrolled=false;this.scrollListener=this.onScroll.bind(this);this.el.addEventListener("scroll",this.scrollListener)}},{key:"onScroll",value:function onScroll(){this.mtnOffset.setTarget(this.el.scrollTop);if(this.el.scrollTop>10&&this.scrolled==false){document.body.classList.add("home-scrolled");this.scrolled=true}else if(this.el.scrollTop<=10&&this.scrolled==true){document.body.classList.remove("home-scrolled");this.scrolled=false}}},{key:"dispose",value:function dispose(){setTimeout(function(){document.body.classList.remove("video-menu")},1e3);_store.removeListener(this);this.el.removeEventListener("scroll",this.scrollListener);document.body.classList.remove("home-scrolled")}}]);return AreaHome}();window.AreaHome=AreaHome;"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var AreaAbout=function(){function AreaAbout(el){_classCallCheck(this,AreaAbout);this.el=el;this.el.scrollTop=0;_store.set(Proceeds.THREE_PAUSED,true);this.blueTopoEl=this.el.querySelector(".blue-topo-shape");this.addKeyHandler();this.addScrollHandler()}_createClass(AreaAbout,[{key:"addKeyHandler",value:function addKeyHandler(){this.keyHandler=this.keyDown.bind(this);window.addEventListener("keydown",this.keyHandler)}},{key:"keyDown",value:function keyDown(e){var key=e.keyCode?e.keyCode:e.which;if(key==27){_store.set(Proceeds.NAVIGATION_PATH,"home")}}},{key:"addScrollHandler",value:function addScrollHandler(){this.scrolled=false;this.scrollListener=this.onScroll.bind(this);this.el.addEventListener("scroll",this.scrollListener)}},{key:"onScroll",value:function onScroll(){if(this.el.scrollTop>10&&this.scrolled==false){document.body.classList.add("about-scrolled");this.scrolled=true}else if(this.el.scrollTop<=10&&this.scrolled==true){document.body.classList.remove("about-scrolled");this.scrolled=false}var dir=window.innerWidth<640?1:-1;this.blueTopoEl.style.transform="translateY("+dir*(this.el.scrollTop*.2)+"px) rotate("+this.el.scrollTop*.25+"deg)"}},{key:"dispose",value:function dispose(){window.removeEventListener("keydown",this.keyHandler);_store.set(Proceeds.THREE_PAUSED,false);this.el.removeEventListener("scroll",this.scrollListener);document.body.classList.remove("about-scrolled")}}]);return AreaAbout}();window.AreaAbout=AreaAbout;"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var AreaAframe=function(){function AreaAframe(el){_classCallCheck(this,AreaAframe);_store.addListener(this);this.aframeEl=el;this.initVrState();this.initTimer();this.animate()}_createClass(AreaAframe,[{key:"initVrState",value:function initVrState(){var _this=this;_store.set(Proceeds.VR_ACTIVE,false);document.body.classList.add("vr-inactive");this.aframeEl.addEventListener("enter-vr",function(){return _this.onVrEntered()});this.aframeEl.addEventListener("exit-vr",function(){return _this.onVrExited()})}},{key:"onVrEntered",value:function onVrEntered(){document.body.classList.add("vr-active");document.body.classList.remove("vr-inactive");_store.set(Proceeds.VR_ACTIVE,true);_store.set(Proceeds.CONTROL_MODE,Proceeds.CONTROL_MODE_VR)}},{key:"onVrExited",value:function onVrExited(){document.body.classList.remove("vr-active");document.body.classList.add("vr-inactive");_store.set(Proceeds.VR_ACTIVE,false);this.setNonVRControl();this.canvas.style.padding="0px"}},{key:"storeThreeScene",value:function storeThreeScene(){var aframeScene=document.querySelector("a-scene").object3D;_store.set(Proceeds.THREE_SCENE,aframeScene)}},{key:"waitForInjectedCamera",value:function waitForInjectedCamera(){if(_store.get(Proceeds.THREE_CAMERA))return;this.cameraEl=document.querySelector("[camera]");if(this.cameraEl&&this.cameraEl.object3D&&this.cameraEl.object3D.children&&this.cameraEl.object3D.children.length>0){this.storeThreeScene();this.buildCamera()}}},{key:"buildCamera",value:function buildCamera(){this.canvas=document.querySelector("canvas");window.cameraEl=this.cameraEl;this.cameraEl.removeAttribute("wasd-controls");this.cameraEl.setAttribute("look-controls","reverseMouseDrag: false");this.cameraEl.setAttribute("camera","userHeight: 0");this.cameraObj=this.cameraEl.object3D.children[0];_store.set(Proceeds.THREE_CAMERA,this.cameraObj);this.finishLoadingScene()}},{key:"finishLoadingScene",value:function finishLoadingScene(){this.initScene();this.initVRButton();this.initMouseControls()}},{key:"initVRButton",value:function initVRButton(){var vrButton=document.querySelector(".a-enter-vr");vrButton.classList.add("audio-unmute")}},{key:"initScene",value:function initScene(){this.loader=new Loader;this.cursor=new Cursor;this.videoSphere=new VideoSphere;this.menu=new Menu3d;this.gameInstructions=new GameInstructions;this.gameScoreboard=new GameScoreboard;this.gameMenu=new GameMenu;this.gameMultiplier=new GameMultiplier;this.gameParticles=new GameParticles;this.videoTexts=new VideoTexts;this.vrSpatialArrows=new SpatialArrows}},{key:"initTimer",value:function initTimer(){this.frameCount=1;this.lastRenderTime=0}},{key:"updateAnimateTime",value:function updateAnimateTime(){var timestamp=Date.now();var delta=Math.min(timestamp-this.lastRenderTime,500);this.lastRenderTime=timestamp;this.frameCount++;_store.set(Proceeds.REQUEST_ANIMATION_FRAME,delta)}},{key:"animate",value:function animate(){var _this2=this;this.updateAnimateTime();this.waitForInjectedCamera();this.updateUserInput();window.requestAnimationFrame(function(){return _this2.animate()})}},{key:"storeUpdated",value:function storeUpdated(key,value){if(key==Proceeds.CONTROL_MODE){if(value==Proceeds.CONTROL_MODE_DESKTOP)this.disableHeadTracking();else this.enableHeadTracking()}}},{key:"enableHeadTracking",value:function enableHeadTracking(){this.orbitControls.reset(this.cameraObj,0,0);this.cameraEl.setAttribute("look-controls","enabled: true")}},{key:"disableHeadTracking",value:function disableHeadTracking(){this.cameraEl.setAttribute("look-controls","enabled: false");this.cameraEl.setAttribute("rotation","0 0 0")}},{key:"setNonVRControl",value:function setNonVRControl(){if(AFRAME.utils.device.isMobile()){_store.set(Proceeds.CONTROL_MODE,Proceeds.CONTROL_MODE_MOBILE)}else{_store.set(Proceeds.CONTROL_MODE,Proceeds.CONTROL_MODE_DESKTOP)}}},{key:"initMouseControls",value:function initMouseControls(){this.orbitControls=new OrbitControls;this.setNonVRControl()}},{key:"updateUserInput",value:function updateUserInput(){if(this.cameraObj){if(AFRAME.utils.device.isMobile()==false){if(_store.get(Proceeds.CONTROL_MODE)==Proceeds.CONTROL_MODE_DESKTOP){var mouseX=window.proceeds.pointerPos.xPercent()>0?window.proceeds.pointerPos.xPercent():.5;var mouseY=window.proceeds.pointerPos.yPercent()>0?window.proceeds.pointerPos.yPercent():.5;var xMult=460;var yMult=170;if(_store.get(Proceeds.CUR_PATH_UPDATED)=="/home"){xMult*=.1;yMult*=.1}this.orbitControls.update(this.cameraObj,(-.5+mouseX)*xMult,(-.5+mouseY)*yMult)}}}}},{key:"dispose",value:function dispose(){}}]);return AreaAframe}();window.AreaAframe=AreaAframe;"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var AreaVideo=function(){function AreaVideo(path){_classCallCheck(this,AreaVideo);this.playMedia(path);this.addKeyHandler()}_createClass(AreaVideo,[{key:"playMedia",value:function playMedia(path){if(!Config.media[path])return;if(Config.media[path].indexOf("jpg")!=-1){_store.set(Proceeds.CURRENT_360_IMAGE,Config.media[path]);_store.set(Proceeds.CURRENT_360_MEDIA,Config.media[path])}else{_store.set(Proceeds.CURRENT_360_VIDEO,Config.media[path]);_store.set(Proceeds.CURRENT_360_MEDIA,Config.media[path])}}},{key:"addKeyHandler",value:function addKeyHandler(){this.keyHandler=this.keyDown.bind(this);window.addEventListener("keydown",this.keyHandler)}},{key:"keyDown",value:function keyDown(e){var key=e.keyCode?e.keyCode:e.which;if(key==27){if(_store.get(Proceeds.CUR_PATH_UPDATED)!="home"){_store.set(Proceeds.GO_BACK,true)}}}},{key:"dispose",value:function dispose(){window.removeEventListener("keydown",this.keyHandler);_store.set(Proceeds.THREE_PAUSED,false)}}]);return AreaVideo}();window.AreaVideo=AreaVideo;"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var AreaGame=function(_AreaVideo){_inherits(AreaGame,_AreaVideo);function AreaGame(el){_classCallCheck(this,AreaGame);var _this=_possibleConstructorReturn(this,(AreaGame.__proto__||Object.getPrototypeOf(AreaGame)).call(this,el));_store.addListener(_this);_this.gameTime=Config.GAME_SECONDS*1e3;_this.sphereIndex=0;_store.set(Proceeds.GAME_ACTIVE,false);_store.set(Proceeds.GAME_SECTION_ACTIVE,true);_store.set(Proceeds.POINT_COLOR,"#ffffff");_store.set(Proceeds.POINT_RADS,0);setTimeout(function(){_store.set(Proceeds.GAME_INSTRUCTIONS_SHOWING,true)},300);_this.spherePool=_this.getSpherePool();return _this}_createClass(AreaGame,[{key:"getSpherePool",value:function getSpherePool(){if(typeof _store.get(Proceeds.SPHERE_POOL)==="undefined"){_store.set(Proceeds.SPHERE_POOL,new ObjectPool(GameSphere))}return _store.get(Proceeds.SPHERE_POOL)}},{key:"storeUpdated",value:function storeUpdated(key,value){if(key==Proceeds.GAME_ACTIVE&&value==true)this.gameStart();if(key==Proceeds.GAME_POINTS)this.checkCleared();if(key==Proceeds.GAME_ACTIVE&&value==true)document.body.classList.add("game-active");if(key==Proceeds.GAME_ACTIVE&&value==false)document.body.classList.remove("game-active")}},{key:"gameStart",value:function gameStart(){_store.set(Proceeds.GAME_POINTS,0);_store.set(Proceeds.GAME_INSTRUCTIONS_SHOWING,false);_store.set(Proceeds.PLAY_SOUND,Config.SOUNDS.START);this.clearStreak();this.numSpheres=4;this.startTime=Date.now();this.lastSphereLaunch=this.startTime-4e3;this.sphereStartRads=_store.get(Proceeds.CONTROL_MODE)==Proceeds.CONTROL_MODE_DESKTOP?0:Config.BUTTONS_ROT_OFFSET;this.sphereRads=this.sphereStartRads;this.animate()}},{key:"animate",value:function animate(){var _this2=this;if(_store.get(Proceeds.GAME_SECTION_ACTIVE)==true)requestAnimationFrame(function(){return _this2.animate()});if(_store.get(Proceeds.GAME_ACTIVE)==false)return;this.updateTimer();this.checkLaunchSphere()}},{key:"updateTimer",value:function updateTimer(){var timerCountdown=this.gameTime-(Date.now()-this.startTime);var curSeconds=Math.ceil(timerCountdown/1e3);if(curSeconds>=0){if(curSeconds!=_store.get(Proceeds.GAME_TIMER)){if(curSeconds<=4){_store.set(Proceeds.PLAY_SOUND,Config.SOUNDS.ALARM);_store.set(Proceeds.GAME_TIMER_RUNNING_OUT,true)}}_store.set(Proceeds.GAME_TIMER,curSeconds)}else{_store.set(Proceeds.GAME_TIMER,0);this.gameOver()}}},{key:"gameOver",value:function gameOver(){this.clearStreak();_store.set(Proceeds.GAME_ACTIVE,false);_store.set(Proceeds.PLAY_SOUND,Config.SOUNDS.BUZZER)}},{key:"checkLaunchSphere",value:function checkLaunchSphere(){if(Date.now()>this.lastSphereLaunch+GameSphere.ALIVE_TIME){if(_store.get(Proceeds.GAME_STREAK)>0)_store.set(Proceeds.PLAY_SOUND,Config.SOUNDS.SLIDE_DOWN);this.clearStreak()}if(Date.now()>this.lastSphereLaunch+GameSphere.ALIVE_TIME+1500){this.launchSpheres()}}},{key:"launchSpheres",value:function launchSpheres(){var _this3=this;this.lastSphereLaunch=Date.now();this.numCaptured=0;var yOsc=Math.random()*2*Math.PI;var yFreqAdd=.2+Math.random();var addOrSubtract=Math.random()>.5?1:-1;var numSpheres=this.numSpheres+_store.get(Proceeds.GAME_STREAK);for(var i=0;i<numSpheres;i++){setTimeout(function(){if(_store.get(Proceeds.GAME_ACTIVE)){_this3.sphereIndex++;var pastBounds=Math.abs(_this3.sphereRads-_this3.sphereStartRads)>Math.PI*.75;if(pastBounds){addOrSubtract=_this3.sphereRads<_this3.sphereStartRads?1:-1}var radsStep=pastBounds==false?.35:.4;_this3.sphereRads+=radsStep*addOrSubtract;yOsc+=yFreqAdd;var sphere=_this3.spherePool.getObject();sphere.add(_this3.sphereRads,.5*Math.sin(yOsc),1+.25*Math.cos(yOsc/2),_this3.sphereIndex);_store.set(Proceeds.PLAY_SOUND,Config.SOUNDS.DRIP);_this3.lastSphereLaunch=Date.now()}},i*100)}}},{key:"increaseStreak",value:function increaseStreak(){_store.set(Proceeds.GAME_STREAK,_store.get(Proceeds.GAME_STREAK)+1);_store.set(Proceeds.PLAY_SOUND,Config.SOUNDS.STREAK)}},{key:"clearStreak",value:function clearStreak(){_store.set(Proceeds.POINT_COLOR,"#ffffff");_store.set(Proceeds.GAME_STREAK,0)}},{key:"checkCleared",value:function checkCleared(){this.numCaptured++;if(this.numSpheres+_store.get(Proceeds.GAME_STREAK)==this.numCaptured){this.increaseStreak();this.launchSpheres()}}},{key:"killActiveSpheres",value:function killActiveSpheres(){this.spherePool.pool().forEach(function(el,i){setTimeout(function(){el.hover()},i*20)})}},{key:"dispose",value:function dispose(){_store.set(Proceeds.GAME_POINTS,0);this.clearStreak();_store.set(Proceeds.GAME_SECTION_ACTIVE,false);_store.set(Proceeds.GAME_ACTIVE,false);this.killActiveSpheres();document.body.classList.remove("pointer-cursor");clearTimeout(this.instructionsTimeout);_store.removeListener(this)}}]);return AreaGame}(AreaVideo);window.AreaGame=AreaGame;"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var AreaUpgrade=function(){function AreaUpgrade(el){_classCallCheck(this,AreaUpgrade);this.el=el;this.el.scrollTop=0;_store.set(Proceeds.THREE_PAUSED,true)}_createClass(AreaUpgrade,[{key:"dispose",value:function dispose(){_store.set(Proceeds.THREE_PAUSED,false)}}]);return AreaUpgrade}();window.AreaUpgrade=AreaUpgrade;"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
	var Config=function Config(){
		_classCallCheck(this,Config)};
		Config.VIDEO_SPHERE_SIZE=20;
		Config.VIDEO_RATE=1;
		Config.SPHERE_ROTATION_VR=-Math.PI/2;
		Config.SPHERE_ROTATION_DESKTOP=Math.PI;
		Config.BASE_Y=1.6;
		if(typeof THREE!=="undefined")
			Config.BASE_Y_CAMERA=new
		THREE.Vector3(0,1.6,0);
		Config.CAMERA_TARGET_DISTANCE=-2.5;
		Config.BUTTONS_ROT_OFFSET=-Math.PI/2;
		Config.MENU_OPEN_ICON="/giving-back/assets/images/vr/3d/buttons/icon-menu-256.png";
		Config.MENU_COSE_ICON="/giving-back/assets/images/vr/3d/buttons/icon-close-256.png";
		Config.BUTTON_DISTANCE=5;
		Config.BUTTON_TOGGLE_DISTANCE=14;
		Config.MENU_TOGGLE_Y=Config.BASE_Y-8;
		Config.BUTTON_SIZE=1;
		Config.ARROW_IMG="/giving-back/assets/images/vr/3d/arrow.png";
		Config.ARROWS_Y=0;
		Config.ARROWS_DISTANCE=8;
		Config.LOOK_UP_IMG="/giving-back/assets/images/vr/3d/look-up-text.png";
		Config.LOOK_UP_Y=-10;
		Config.LOOK_UP_DISTANCE=3;
		Config.GAME_SPHERE_RADIUS=6;
		Config.GAME_SPHERE_Y_RANGE=2;
		Config.INSTRUCTIONS_BANNER_IMG="/giving-back/assets/images/vr/3d/instruction-text-overlay.png";
		Config.VIDEO_CLIMBING_TEXT_IMG="/giving-back/assets/images/vr/3d/climbing.png";
		Config.VIDEO_BIKING_TEXT_IMG="/giving-back/assets/images/vr/3d/biking.png";
		Config.VIDEO_SKIING_TEXT_IMG="/giving-back/assets/images/vr/3d/skiing.png";
		Config.VIDEO_MUSTANG_TEXT_IMG="/giving-back/assets/images/vr/3d/mustang.png";
		Config.VIDEO_OURAY_TEXT_IMG="/giving-back/assets/images/vr/3d/ouray.png";
		Config.VIDEO_INTRO_TEXT_IMG="/giving-back/assets/images/vr/3d/intro_es.png";
		Config.VIDEO_LOTTERY_LOGO="/giving-back/assets/images/vr/3d/lottery-logo.png";
		Config.VIDEO_TEXT_Y=Config.BASE_Y+1;
		Config.INSTRUCTIONS_PLANE_DISTANCE=14;
		Config.GAME_INSTRUCTIONS_HEIGHT=4;
		Config.VIDEO_TEXT_HEIGHT=2.2;
		Config.INSTRUCTIONS_Y=Config.BASE_Y-1;
		Config.MULTIPLIER_Y=Config.BASE_Y+4;
		Config.GAME_MULTIPLIER_DISTANCE=13;
		Config.GAME_SCORE_DISTANCE=14;
		Config.GAME_SCORE_BG_IMG="/giving-back/assets/images/vr/3d/score-background-512.png";
		Config.GAME_SECONDS=30;
		Config.GAME_START_BUTTON_IMAGE="/giving-back/assets/images/vr/3d/buttons/game-start-button.png";
		Config.GAME_REPLAY_BUTTON_IMAGE="/giving-back/assets/images/vr/3d/buttons/game-replay-button.png";
		Config.GAME_START_BUTTON_Y=Config.BASE_Y-5;
		Config.GAME_START_BUTTON_SIZE=1.6;
		Config.HOVER_TIME=1500;
		Config.REMOVE_VR_ON_DESKTOP=false;
		Config.media={
			home:"/giving-back/assets/images/vr/360/biking-home.jpg",
			game:"/giving-back/assets/images/vr/360/biking-02-23-00.jpg",
			biking:"/giving-back/assets/images/vr/360/colorado-lottery-proceeds-biking.mp4",
			climbing:"/giving-back/assets/images/vr/360/colorado-lottery-proceeds-climbing.mp4",
			skiing:"/giving-back/assets/images/vr/360/colorado-lottery-proceeds-skiing.mp4",
			mustang:"/giving-back/assets/images/vr/360/colorado-lottery-proceeds-mustang-pavilion.mp4",
			ouray:"/giving-back/assets/images/vr/360/colorado-lottery-proceeds-ouray.mp4"
		};
		if(typeof AFRAME!=="undefined"&&AFRAME.utils.device.isMobile()==true){
			Config.media.biking="/giving-back/assets/images/vr/360/colorado-lottery-proceeds-biking-mobile.mp4";
			Config.media.climbing="/giving-back/assets/images/vr/360/colorado-lottery-proceeds-climbing-mobile.mp4";
			Config.media.skiing="/giving-back/assets/images/vr/360/colorado-lottery-proceeds-skiing-mobile.mp4";
			Config.media.mustang="/giving-back/assets/images/vr/360/colorado-lottery-proceeds-mustang-pavilion-mobile.mp4";
			Config.media.ouray="/giving-back/assets/images/vr/360/colorado-lottery-proceedsouray-mobile.mp4"
		}
		Config.SOUNDS={POP_1:"/giving-back/assets/audio/pop-1.mp3",POP_2:"/giving-back/assets/audio/pop-2.mp3",POP_3:"/giving-back/assets/audio/pop-3.mp3",POP_4:"/giving-back/assets/audio/pop-4.mp3",START:"/giving-back/assets/audio/start.mp3",STREAK:"/giving-back/assets/audio/streak-2.mp3",SLIDE_DOWN:"/giving-back/assets/audio/slide-down.mp3",BUZZER:"/giving-back/assets/audio/buzzer.mp3",DRIP:"/giving-back/assets/audio/drip.mp3",ALARM:"/giving-back/assets/audio/alarm.mp3"};Config.SOUNDS.POP=[Config.SOUNDS.POP_1,Config.SOUNDS.POP_2,Config.SOUNDS.POP_3,Config.SOUNDS.POP_4];"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Proceeds=function(){function Proceeds(){var _this=this;_classCallCheck(this,Proceeds);this.hasTHREE=typeof AFRAME!=="undefined"&&typeof THREE!=="undefined";DOMUtil.addLoadedClass();if(window.location.hash.match(/embedded/))document.body.classList.add("in-app");if(!this.hasWebGL()&&this.hasTHREE==true)document.body.classList.add("help");requestAnimationFrame(function(){return _this.init()});this.prepareCloseButton()}_createClass(Proceeds,[{key:"hasWebGL",value:function hasWebGL(){var canvas=document.createElement("canvas");return!!(window.WebGLRenderingContext&&(canvas.getContext("webgl")||canvas.getContext("experimental-webgl")))}},{key:"init",value:function init(){this.appStore=new AppStore;_store.addListener(this);this.initRoutes();this.addNavKeyHandler();this.initVisibility();if(this.hasTHREE){this.initInput();this.initAframe();this.initAudio()}}},{key:"storeUpdated",value:function storeUpdated(key,value){if(key==Proceeds.NAVIGATION_PATH){if(value=="/")value="home";page(value)}if(key==Proceeds.CUR_PATH_UPDATED)this.setSection(value);if(key==Proceeds.GO_BACK)this.back()}},{key:"initAframe",value:function initAframe(){this.aframeEl=document.querySelector("a-scene");this.areaAframe=new AreaAframe(this.aframeEl)}},{key:"initInput",value:function initInput(){document.addEventListener("touchstart",function(){},false);var deviceClass=AFRAME.utils.device.isMobile()==true?"mobile":"desktop";document.body.classList.add(deviceClass);this.pointerPos=new PointerPos}},{key:"initVisibility",value:function initVisibility(){_store.set(Proceeds.THREE_PAUSED,false);_store.set(Proceeds.PAGE_ACTIVE_STATE,Proceeds.PAGE_ACTIVE);this.pageVisibility=new PageVisibility(this.pageActive.bind(this),this.pageInactive.bind(this))}},{key:"pageActive",value:function pageActive(){_store.set(Proceeds.PAGE_ACTIVE_STATE,Proceeds.PAGE_ACTIVE)}},{key:"pageInactive",value:function pageInactive(){_store.set(Proceeds.PAGE_ACTIVE_STATE,Proceeds.PAGE_INACTIVE)}},{key:"initAudio",value:function initAudio(){this.audioToggle=new AudioToggle;this.soundPlayer=new SoundPlayer(Config.SOUNDS,Config.SOUNDS.POP_1)}},{key:"prepareCloseButton",value:function prepareCloseButton(){var closeBtn=document.querySelector(".vr-close-button");closeBtn.addEventListener("click",function(e){e.preventDefault();_store.set(Proceeds.GO_BACK,true)})}},{key:"initRoutes",value:function initRoutes(){var _this2=this;page("/",function(ctx){return _this2.route(ctx)});page("*",function(ctx){return _this2.route(ctx)});page({popstate:false,hashbang:true})}},{key:"route",value:function route(ctx){var path=ctx.path;if(path=="/")path="home";if(path.indexOf("/")==0)path=path.substr(1);_store.set(Proceeds.CUR_PATH_UPDATED,path)}},{key:"setSection",value:function setSection(path){if(this.curArea){document.body.classList.remove("section-"+this.lastPath);this.curArea.dispose()}else{_store.set(Proceeds.FIRST_PATH,path)}
		if(path=="home")this.curArea=new AreaVideo(path);
		if(path=="biking")this.curArea=new AreaVideo(path);
		if(path=="climbing")this.curArea=new AreaVideo(path);
		if(path=="skiing")this.curArea=new AreaVideo(path);
		if(path=="mustang")this.curArea=new AreaVideo(path);
		if(path=="ouray")this.curArea=new AreaVideo(path);
		if(path=="game")this.curArea=new AreaGame(path);
		if(path=="game/embedded")this.curArea=new AreaGame("game");
		this.lastPath=path;document.body.classList.add("section-"+path)}},{key:"back",value:function back(){if(_store.get(Proceeds.FIRST_PATH)=="home"){_store.set(Proceeds.NAVIGATION_PATH,"home")}else{window.history.back()}}},{key:"addNavKeyHandler",value:function addNavKeyHandler(){this.keyHandler=this.keyDown.bind(this);window.addEventListener("keydown",this.keyHandler)}},{key:"keyDown",value:function keyDown(e){var key=e.keyCode?e.keyCode:e.which;
			if(document.body.classList.contains("vr-active")){
				if(key==49)this.loadSectionWithAutoplay("home",false);
				if(key==50)this.loadSectionWithAutoplay("biking",false);
				if(key==51)this.loadSectionWithAutoplay("climbing",false);
				if(key==52)this.loadSectionWithAutoplay("skiing",false);
				if(key==55)this.loadSectionWithAutoplay("mustang",false);
				if(key==56)this.loadSectionWithAutoplay("ouray",false);
				if(key==53)this.loadSectionWithAutoplay("game",false);
				if(key==54)this.loadSectionWithAutoplay("biking",true)}}},{key:"loadSectionWithAutoplay",value:function loadSectionWithAutoplay(path,autoplay){_store.set(Proceeds.NAVIGATION_PATH,path);_store.set(Proceeds.AUTOPLAY_ALL_VIDEOS,autoplay)}}]);return Proceeds}();Proceeds.VR_ACTIVE="VR_ACTIVE";Proceeds.CONTROL_MODE="CONTROL_MODE";Proceeds.CONTROL_MODE_DESKTOP="CONTROL_MODE_DESKTOP";Proceeds.CONTROL_MODE_VR="CONTROL_MODE_VR";Proceeds.CONTROL_MODE_MOBILE="CONTROL_MODE_MOBILE";Proceeds.CURRENT_360_IMAGE="CURRENT_360_IMAGE";Proceeds.CURRENT_360_VIDEO="CURRENT_360_VIDEO";Proceeds.CURRENT_360_MEDIA="CURRENT_360_MEDIA";Proceeds.LOADING_360_TEXTURE="LOADING_360_TEXTURE";Proceeds.LOADER_HIDDEN="LOADER_HIDDEN";Proceeds.VIDEO_BUFFERING="VIDEO_BUFFERING";Proceeds.VIDEO_FINISHED="VIDEO_FINISHED";Proceeds.VIDEO_PROGRESS_25="VIDEO_PROGRESS_25";Proceeds.VIDEO_PROGRESS_50="VIDEO_PROGRESS_50";Proceeds.VIDEO_PROGRESS_75="VIDEO_PROGRESS_75";Proceeds.SHOW_VIDEO_INTRO_TEXT="SHOW_VIDEO_INTRO_TEXT";Proceeds.SHOW_VIDEO_OUTRO_TEXT="SHOW_VIDEO_OUTRO_TEXT";Proceeds.SHOW_3D_MENU="SHOW_3D_MENU";Proceeds.MENU_3D_SHOWING="MENU_3D_SHOWING";Proceeds.THREE_SCENE="THREE_SCENE";Proceeds.THREE_CAMERA="THREE_CAMERA";Proceeds.REQUEST_ANIMATION_FRAME="REQUEST_ANIMATION_FRAME";Proceeds.THREE_PAUSED="THREE_PAUSED";Proceeds.PAGE_ACTIVE_STATE="PAGE_ACTIVE_STATE";Proceeds.PAGE_ACTIVE="PAGE_ACTIVE";Proceeds.PAGE_INACTIVE="PAGE_INACTIVE";Proceeds.ADD_CLICKABLE="ADD_CLICKABLE";Proceeds.REMOVE_CLICKABLE="REMOVE_CLICKABLE";Proceeds.NAVIGATION_PATH="NAVIGATION_PATH";Proceeds.CUR_PATH_UPDATED="CUR_PATH_UPDATED";Proceeds.FIRST_PATH="FIRST_PATH";Proceeds.GO_BACK="GO_BACK";Proceeds.AUTOPLAY_ALL_VIDEOS="AUTOPLAY_ALL_VIDEOS";Proceeds.SHOW_HOME_VIDEO_MENU="SHOW_HOME_VIDEO_MENU";Proceeds.TOGGLE_HOME_VIDEO_MENU_EVENT="TOGGLE_HOME_VIDEO_MENU_EVENT";Proceeds.AUDIO_MUTED="AUDIO_MUTED";Proceeds.GAME_SECTION_ACTIVE="GAME_SECTION_ACTIVE";Proceeds.GAME_ACTIVE="GAME_ACTIVE";Proceeds.GAME_POINTS="GAME_POINTS";Proceeds.GAME_STREAK="GAME_STREAK";Proceeds.POINT_COLOR="POINT_COLOR";Proceeds.POINT_RADS="POINT_RADS";Proceeds.POINT_POSITION="POINT_POSITION";Proceeds.GAME_TIMER="GAME_TIMER";Proceeds.GAME_START="GAME_START";Proceeds.GAME_TIMER_RUNNING_OUT="GAME_TIMER_RUNNING_OUT";Proceeds.SPHERE_POOL="SPHERE_POOL";Proceeds.GAME_INSTRUCTIONS_SHOWING="GAME_INSTRUCTIONS_SHOWING";Proceeds.PLAY_SOUND="PLAY_SOUND";Proceeds.SHARE_FACEBOOK="SHARE_FACEBOOK";Proceeds.SHARE_TWITTER="SHARE_TWITTER";window.proceeds=new Proceeds;
